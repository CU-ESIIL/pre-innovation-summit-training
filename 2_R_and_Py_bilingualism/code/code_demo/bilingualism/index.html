
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for May 2023 ESIIL Innovation Summit">
      
      
        <meta name="author" content="ESIIL Education and CI">
      
      
        <link rel="canonical" href="https://cu-esiil.github.io/pre-innovation-summit-training/2_R_and_Py_bilingualism/code/code_demo/bilingualism/">
      
      
        <link rel="prev" href="../../outline/outline/">
      
      
        <link rel="next" href="../../../../3_Tools_for_reproducible_and_open_science/openscience/">
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Code examples - Innovation Summit 2023</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#r-and-python-bilingualism" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Innovation Summit 2023" class="md-header__button md-logo" aria-label="Innovation Summit 2023" data-md-component="logo">
      
  <img src="../../../../assets/ESIIL_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Innovation Summit 2023
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Code examples
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: white)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cu-esiil/pre-innovation-summit-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pre-innovation-summit-training
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../1_Collaboration_on_Cloud/collaboration/" class="md-tabs__link">
          
  
    
  
  Collaboration on Cloud

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../outline/outline/" class="md-tabs__link">
          
  
    
  
  R and Python Bilingualism

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../3_Tools_for_reproducible_and_open_science/openscience/" class="md-tabs__link">
          
  
    
  
  Reproducible and Open Science

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Innovation Summit 2023" class="md-nav__button md-logo" aria-label="Innovation Summit 2023" data-md-component="logo">
      
  <img src="../../../../assets/ESIIL_logo.png" alt="logo">

    </a>
    Innovation Summit 2023
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cu-esiil/pre-innovation-summit-training" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pre-innovation-summit-training
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Collaboration on Cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Collaboration on Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../1_Collaboration_on_Cloud/collaboration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration on Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../1_Collaboration_on_Cloud/github_lesson/github_lesson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github essentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../1_Collaboration_on_Cloud/jetstream2_lesson/jetstream2_lesson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jetstream2 Intro
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    R and Python Bilingualism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            R and Python Bilingualism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outline/outline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Code examples
  </span>
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reproducible and Open Science
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reproducible and Open Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../3_Tools_for_reproducible_and_open_science/openscience/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools for Reproducible and Open Science
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="r-and-python-bilingualism">R and Python bilingualism<a class="headerlink" href="#r-and-python-bilingualism" title="Permanent link">&para;</a></h1>
<h1 id="welcome-to-the-r-and-python-bilingualism-reference-guide">Welcome to the R and Python bilingualism reference guide!<a class="headerlink" href="#welcome-to-the-r-and-python-bilingualism-reference-guide" title="Permanent link">&para;</a></h1>
<p>If you’re fluent in one of these languages but hesitant to learn the
other, you’re in the right place. The good news is that there are many
similarities between R and Python that make it easy to switch between
the two.</p>
<p>Both R and Python are widely used in data science and are open-source,
meaning that they are free to use and constantly being improved by the
community. They both have extensive libraries for data analysis,
visualization, and machine learning. In fact, many of the libraries in
both languages have similar names and functions, such as Pandas in
Python and data.table in R.</p>
<p>While there are differences between the two languages, they can
complement each other well. Python is versatile and scalable, making it
ideal for large and complex projects such as web development and
artificial intelligence. Object-oriented programming is easier and more
common in Python, which is useful for large development teams. R, on the
other hand, is known for its exceptional statistical capabilities and is
often used in data analysis and modeling. Visualization is also easier
in R, making it a popular choice for creating graphs and charts.</p>
<p>By learning both R and Python, you’ll be able to take advantage of the
strengths of each language and create more efficient and robust data
analysis workflows. Don’t let the differences between the two languages
intimidate you - once you become familiar with one, learning the other
will be much easier.</p>
<p>So, whether you’re a Python enthusiast looking to expand your
statistical analysis capabilities, or an R user interested in exploring
the world of web development and artificial intelligence, this guide
will help you become bilingual in R and Python.</p>
<h2 id="try-it-yourself">Try it yourself!<a class="headerlink" href="#try-it-yourself" title="Permanent link">&para;</a></h2>
<p>We have hidden most of the code in this notebook so that you can try to
work it out yourself first if you like. We challenge you to pick the
coding language you are least familiar with and try writing these
workflows. If you need help, you can look at the code in the more
familiar language, or check out our version in the less familiar for
hints.</p>
<h2 id="how-to-get-help">How to get help<a class="headerlink" href="#how-to-get-help" title="Permanent link">&para;</a></h2>
<p>If you know how to get help with one programming language, it’s not too
different in a different one.</p>
<h3 id="offline-in-your-coding-environment">Offline in your coding environment<a class="headerlink" href="#offline-in-your-coding-environment" title="Permanent link">&para;</a></h3>
<p>In both R and Python, you can print out the documentation for any
function or object using the <code>help()</code> function. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nf">help</span><span class="p">(</span><span class="n">print</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">help</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Help on built-in function print in module builtins:

print(...)
    print(value, ..., sep=&#39; &#39;, end=&#39;\n&#39;, file=sys.stdout, flush=False)

    Prints the values to a stream, or to sys.stdout by default.
    Optional keyword arguments:
    file:  a file-like object (stream); defaults to the current sys.stdout.
    sep:   string inserted between values, default a space.
    end:   string appended after the last value, default a newline.
    flush: whether to forcibly flush the stream.
</code></pre></div>
<h3 id="official-documentation-pages">Official documentation pages<a class="headerlink" href="#official-documentation-pages" title="Permanent link">&para;</a></h3>
<p>There are also some great documentation of Python, R, and third party
libraries on the internet. You can find the same information about
parameters, attributes, returns, and methods that you get by running
<code>help()</code>, online. We also recommend checking out the associated <strong>user
guides</strong> and <strong>plot gallerys</strong>!</p>
<p>Here are some of our favorite documentation pages. First, manuals for
the programming languages:</p>
<ul>
<li>
<p><a href="https://docs.python.org/3.10/">Python manual</a></p>
</li>
<li>
<p><a href="https://rstudio.github.io/r-manuals/">The R manuals</a>, formatted for
  the web</p>
</li>
</ul>
<blockquote>
<p>Note that if you are <strong>citing</strong> a program language, it is conventional
to cite the manual for the version you used unless the authors specify
otherwise.</p>
</blockquote>
<p>Some of our favorite Python libraries for Earth Data Science:</p>
<ul>
<li>
<p><a href="https://docs.xarray.dev/en/stable/">xarray labeled multidimensional
  arrays</a> and <a href="https://corteva.github.io/rioxarray/stable/">rioxarray arrays with
  coordinates</a></p>
</li>
<li>
<p><a href="https://pandas.pydata.org/docs/">pandas data frames: tabular data and
  databases</a> and <a href="https://geopandas.org/en/stable/">geopandas data frames
  with coordinates</a></p>
</li>
<li>
<p><a href="https://seaborn.pydata.org/">Seaborn data visualization</a></p>
</li>
</ul>
<p>Some of our favorite R libraries for Earth Data Science:</p>
<ul>
<li>
<p><a href="https://www.tidyverse.org/">tidyverse collection of libraries for data
  science</a></p>
</li>
<li>
<p><a href="https://ggplot2.tidyverse.org/">ggplot2 data visualization (technically part of tidyverse but often
  used on its own)</a> and <a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html">cowplot figure
  layout</a></p>
</li>
</ul>
<p>We recommend checking out official documentation before heading to sites
like CodeAcademy or GeeksForGeeks that summarize documentation. They are
often missing key details (but can have examples if you are having
trouble finding those)</p>
<h3 id="books">Books<a class="headerlink" href="#books" title="Permanent link">&para;</a></h3>
<p>There are many many books out there on how to learn both R and Python!
We have heard from many learners who had success with the <a href="https://www.oreilly.com/products/books-videos.html">O’Reill
books</a>. In
particular, you can check out the following freely available books for
download or reading on the web:</p>
<ul>
<li><a href="https://greenteapress.com/wp/think-python-2e/">Think Python: How to Think Like a Computer
  Scientist</a> by Dr. Allen
  Downey - This book is especially targeted at developing bilingualism,
  even though it is a Python book. It originally was published as Think
  Java, and then:</li>
</ul>
<div>

  > “Jeff Elkner, a high school teacher in Virginia, adopted my book and
  > translated it into Python. He sent me a copy of his translation, and
  > I had the unusual experience of learning Python by reading my own
  > book.”

  </div>

<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a> by Hadley Wickham
  focuses on tidyverse-style R but covers a lot of the intricacies of
  the language as well.</li>
</ul>
<h3 id="message-boards">Message boards<a class="headerlink" href="#message-boards" title="Permanent link">&para;</a></h3>
<p>Finally, there are lots of sites out there where you can post and answer
questions, or read other peoples’ questions and answers. Some of our
favorites:</p>
<ul>
<li>
<p><a href="https://stackoverflow.com/">StackOverflow</a></p>
</li>
<li>
<p><a href="https://github.com/">GitHub</a> Issues pages for the project in question</p>
</li>
<li>
<p>Or you can search and see what comes up - there are other good but
  more obscure sources out there like Google groups pages</p>
</li>
</ul>
<h3 id="chatgpt">ChatGPT<a class="headerlink" href="#chatgpt" title="Permanent link">&para;</a></h3>
<p>We used ChatGPT to write the first version of this document because it’s
pretty good at coding. Some things you can try:</p>
<ul>
<li>
<p>Paste some code and ask ChatGPT what it does</p>
</li>
<li>
<p>Paste some code and ask ChatGPT to find bugs in it</p>
</li>
<li>
<p>Ask ChatGPT to write you code that does what you want</p>
</li>
<li>
<p>Ask ChatGPT to translate from R to Python or vice versa</p>
</li>
</ul>
<p>While there’s no guarantee, we’ve gotten plenty of working answers out,
with minimal changes needed. ChatGPT can be loaded as an extension to
many development environments like VSCode, although you may hit a pay
wall.</p>
<h2 id="packages-no-need-to-write-it-from-scratch">Packages: No need to write it from scratch<a class="headerlink" href="#packages-no-need-to-write-it-from-scratch" title="Permanent link">&para;</a></h2>
<p>One thing Python and R have in common is they are extendable using
external packages or libraries. You should have all the packages you
need for today installed already.</p>
<blockquote>
<p>Note that <strong>package</strong> and <strong>library</strong> are used interchangeably</p>
</blockquote>
<h3 id="installing-packages">Installing packages<a class="headerlink" href="#installing-packages" title="Permanent link">&para;</a></h3>
<p>R libraries are stored and managed in a repository called CRAN. You can
download and install R packages with the install.packages() function:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Install the dplyr package from CRAN</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;dplyr&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Installing Python packages can be trickier than installing R packages.
Python libraries are stored and managed in a few different repositories
and their dependencies are not regulated as strictly as R libraries are
in CRAN. Python’s default package manager <code>pip</code> can be used in a
terminal or command line to install packages from the <code>PyPI</code> repository,
and this is a good solution if you need to install a single simple
package, like the <code>requests</code> package that provides a clean interface for
downloads. However, <code>pip</code> has long had some challenges, which you are
very likely to run into if you are using a package that requires the
GDAL library for coordinate transformations (like <code>cartopy</code>, <code>rioxarray</code>
or <code>geopandas</code>).</p>
<p>So what is an earth scientist to do? Most packages can also be installed
from the Anaconda repository by using <code>conda install ...</code> or better yet
<code>mamba install ...</code>. <code>mamba</code> is a version of <code>conda</code> that is much faster
at solving environments. For most packages, we also recommending
specifying the <code>conda-forge</code> channel, as below:</p>
<p>bash code to install Python packages:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># First install mamba with conda if needed</span>
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>mamba
<span class="c1"># Install the pandas package from Anaconda</span>
mamba<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>pandas
</code></pre></div>
<p>It is common to install all the packages you need at once to keep from
boxing yourself into a corner with incompatible version numbers, or to
facilitate packaging your own library. In R, the <code>renv</code> library has a
number of tools for enviroment management; in Python, your best bet is
<code>mamba</code>. You should have everything you need already if you are working
on JetStream2. However, if you want to run this code on your own
computer, you can go ahead and install the R and Python environments as
follows, provided that you have renv and mamba installed:</p>
<div class="highlight"><pre><span></span><code><span class="n">renv</span><span class="o">::</span><span class="nf">install</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment.yml
</code></pre></div>
<p>For the Python environment to work within an RMarkdown file, you may
need to run the following code in R:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
<span class="nf">Sys.setenv</span><span class="p">(</span>
<span class="w">  </span><span class="n">RETICULATE_PYTHON</span><span class="o">=</span><span class="nf">path.expand</span><span class="p">(</span>
<span class="w">    </span><span class="s">&#39;~/opt/miniconda3/envs/earth-analytics-python/bin/python&#39;</span><span class="p">))</span>
<span class="nf">use_condaenv</span><span class="p">(</span><span class="s">&#39;earth-analytics-python&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="loading-libraries-in-r-and-python">Loading libraries in R and Python<a class="headerlink" href="#loading-libraries-in-r-and-python" title="Permanent link">&para;</a></h3>
<p>In R, libraries can be loaded using the library() function:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Load the dplyr library</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</code></pre></div>
<p>In Python, libraries can be loaded using the import statement. Here’s an
example:</p>
<p>Python code:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Load the pandas library</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</code></pre></div>
<p>Note that the package or library must be installed from the respective
repository before it can be loaded. Also, make sure you have the correct
repository specified in your system before installing packages. By
default, R uses CRAN as its primary repository, whereas Anaconda uses
its own repository by default.</p>
<p>Importing libraries from R imports all the functions inside the library
under their own name. For example, once you have installed the r package
<code>readr</code>, you can use the included function <code>read.csv()</code> directly. On the
other hand, with a typical Python import like the one for <code>pandas</code>
above, you need to specify the package, e.g. <code>pd.read_csv</code>. This can be
cumbersome if you have to type the package name a lot (that’s why we
<code>import pandas as pd</code> instead of <code>import pandas</code> – our way we only have
to type out the two-letter alias <code>pd</code>). On the other hand, it can also
be really handy if you are trying to figure out what packages you need
to install to use a function in your own code.</p>
<blockquote>
<p><strong>GOTCHA ALERT:</strong> The dot <code>.</code> is a special character in Python, but
not in R. It is kind of like the <code>/</code> in your file system; instead of
navigating your file tree, it navigates a tree structure like a class
or a library.</p>
</blockquote>
<h3 id="reticulate-why-choose">reticulate - Why choose?<a class="headerlink" href="#reticulate-why-choose" title="Permanent link">&para;</a></h3>
<p>The reticulate package lets you run share variables between R and
Python.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: Note that you will need to set the
<code>RETICULATE_PYTHON</code> environment variable correctly in order to get
Python to work using <code>reticulate</code>. The easiest way is by making a
<code>.Renviron</code> file in your project directory.</p>
</blockquote>
<p>You only need to install packages once, but you need to mount those
packages with the library() function each time you open R.</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
</code></pre></div>
<p>Now, let’s create a Python list and assign it to a variable py_list:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="n">py_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</code></pre></div>
<p>We can now print out the py_list variable in Python using the
py_run_string() function:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="nf">py_run_string</span><span class="p">(</span><span class="s">&quot;print(py_list)&quot;</span><span class="p">)</span>
</code></pre></div>
<p>This will output <code>[1, 2, 3]</code> in the Python console.</p>
<p>Now, let’s create an R vector and assign it to a variable r_vec:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="n">r_vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Notice that in Python we use <code>=</code> to assign variables, while in R we
use <code>&lt;-</code>. Actually, we could use either one in R, but here we’re
following the popular <a href="https://style.tidyverse.org/">tidyverse style
guide</a>. In R there is a distinction
between the assignment operator <code>&lt;-</code> and the parameter setting
operator <code>=</code>. In Python these are considered the same.</p>
</blockquote>
<p>We can now print out the py_list variable in R using the py$ syntax to
access Python variables:</p>
<p>R code:</p>
<div class="highlight"><pre><span></span><code><span class="nf">print</span><span class="p">(</span><span class="n">py</span><span class="o">$</span><span class="n">py_list</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">py</span><span class="p">)</span>
</code></pre></div>
<p>This will output [1, 2, 3] in the R console. Conversely, we can get
the R variable <code>r_vec</code> in Python:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">r_vec</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>There’s that dot <code>.</code> again - in this case it is getting the r_vec
variable from within the “R interface object” <code>r</code> similarly to how the
<code>$</code> character gets attributes of the <code>py</code> object.</p>
</blockquote>
<h3 id="load-packages-and-change-settings">Load packages and change settings<a class="headerlink" href="#load-packages-and-change-settings" title="Permanent link">&para;</a></h3>
<p>In both R and Python, it is suggested to do all your library/package
imports at the top of your file. This makes it easier for others to run
or copy your code. However, for the purposes of this tutorial, we are
loading libraries in the code cell where they are used so that you can
copy and paste the entire snippet.</p>
<p>R and Python are two popular programming languages used for data
analysis, statistics, and machine learning. Although they share some
similarities, there are some fundamental differences between them.
Here’s an example code snippet in R and Python to illustrate some of the
differences:</p>
<p>R Code:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a vector of numbers from 1 to 10</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">10</span>

<span class="c1"># Compute the mean of the vector</span>
<span class="n">mean_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mean_x</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[1] 5.5
</code></pre></div>
<p>Python Code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a numpy array of numbers from 1 to 10</span>
<span class="n">x_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Compute the mean of the array</span>
<span class="n">mean_x</span> <span class="o">=</span> <span class="n">x_arr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_x</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>5.0
</code></pre></div>
<p>In this example, we can see that there are several differences between R
and Python:</p>
<p>Syntax: <code>&lt;-</code> in R vs. <code>=</code> in Python; <code>$</code> in R vs. <code>.</code> in Python</p>
<p>Libraries: Python relies heavily on external libraries such as numpy,
pandas, and xarray for data analysis, while R has built-in functions for
many data analysis tasks. The Python libraries require extra
installation steps, but they have the potential to be much faster when
working with large amounts of data because they are compiled to take
full advantage of your hardware and advances in mathematics kernel
libraries.</p>
<p>Function vs. Methods: Python is an object-oriented language, which means
that where you would use a function in R, you often must apply a method
to an object in Python - see <code>mean()</code> in R vs. <code>x_arr.mean()</code> in Python.
Another way to think about this is that functions and methods are verbs
(<code>pd.read_csv()</code>), classes are nouns (<code>csv.writer()</code>), and methods are
also verbs but they act on the object they are part of
(<code>my_csv_writer.writerows()</code>).</p>
<p>Style:</p>
<p>These are just a few of the many differences between R and Python.
Ultimately, the choice between the two languages will depend on your
specific needs and preferences.</p>
<h2 id="using-and-managing-tabular-data">Using and managing tabular data<a class="headerlink" href="#using-and-managing-tabular-data" title="Permanent link">&para;</a></h2>
<h3 id="load-tabular-data-from-the-web">Load tabular data from the web<a class="headerlink" href="#load-tabular-data-from-the-web" title="Permanent link">&para;</a></h3>
<p>For tabular data like comma separate value (CSV) files, all you need to
get started is a web url. Another thing to notice in the following cells
is how to add line breaks in long strings</p>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>

<span class="n">penguins_url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span>
<span class="w">  </span><span class="s">&#39;https://raw.githubusercontent.com/allisonhorst/palmerpenguins/&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&#39;main/inst/extdata/penguins.csv&#39;</span><span class="p">)</span>

<span class="c1"># Load penguins data</span>
<span class="n">penguins_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">penguins_url</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Rows: 344 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (3): species, island, sex
dbl (5): bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g, year

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 344 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 2 more variables: sex &lt;chr&gt;, year &lt;dbl&gt;
</code></pre></div>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">penguins_url</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;https://raw.githubusercontent.com/allisonhorst/palmerpenguins/&#39;</span>
    <span class="s1">&#39;main/inst/extdata/penguins.csv&#39;</span>
<span class="p">)</span>

<span class="c1"># Load in penguins data</span>
<span class="n">penguins_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">penguins_url</span><span class="p">)</span>
<span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>       species     island  bill_length_mm  ...  body_mass_g     sex  year
0       Adelie  Torgersen            39.1  ...       3750.0    male  2007
1       Adelie  Torgersen            39.5  ...       3800.0  female  2007
2       Adelie  Torgersen            40.3  ...       3250.0  female  2007
3       Adelie  Torgersen             NaN  ...          NaN     NaN  2007
4       Adelie  Torgersen            36.7  ...       3450.0  female  2007
..         ...        ...             ...  ...          ...     ...   ...
339  Chinstrap      Dream            55.8  ...       4000.0    male  2009
340  Chinstrap      Dream            43.5  ...       3400.0  female  2009
341  Chinstrap      Dream            49.6  ...       3775.0    male  2009
342  Chinstrap      Dream            50.8  ...       4100.0    male  2009
343  Chinstrap      Dream            50.2  ...       3775.0  female  2009

[344 rows x 8 columns]
</code></pre></div>
<h3 id="forming-reproducible-file-paths">Forming reproducible file paths<a class="headerlink" href="#forming-reproducible-file-paths" title="Permanent link">&para;</a></h3>
<p>In both R and Python, it is important to use <strong>reproducible file paths</strong>
when collaborating on or sharing code. That means files should be
relative to the current directory, or even better inside the home
directory so it can be specified on every computer.</p>
<p>First, we might want to know where the <strong>working directory</strong> is. If you
build a <strong>relative</strong> file path (one that doesn’t start with something
like a <code>/</code> on Unix systems or <code>C://</code> on Windows systems) the working
directory will be where your code looks for that path:</p>
<div class="highlight"><pre><span></span><code><span class="nf">print</span><span class="p">(</span><span class="nf">getwd</span><span class="p">())</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[1] &quot;/Users/elsa/04-workshops/pre-innovation-summit-training/docs/2_R_and_Py_bilingualism/code/code_demo&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>&#39;/Users/elsa/04-workshops/pre-innovation-summit-training/docs/2_R_and_Py_bilingualism/code/code_demo&#39;
</code></pre></div>
<p>Next, let’s make a cross-platform file path to a data directory in your
home folder and set that as your new working directory. Despite the use
of the Unix-style <code>~</code> to indicate the home directory, this code should
work on both Windows and Unix computers. Windows users can check out
<code>help(path.expand)</code> in the R console for more information on what the
home directory is.</p>
<blockquote>
<p>We know that sometimes it doesn’t work to put data in your home
directory. Another option is putting a configuration file with the
data path in the home directory. Keeping the data in your project
directory is also an option.</p>
</blockquote>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="nf">path.expand</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;esiil-summit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r_and_py&#39;</span><span class="p">)</span>

<span class="c1"># Make the data directory</span>
<span class="nf">dir.create</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="n">showWarnings</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">recursive</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;/Users/elsa/esiil-summit/r_and_py&quot;
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>

<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">(),</span> <span class="s1">&#39;esiil-summit&#39;</span><span class="p">,</span> <span class="s1">&#39;r_and_py&#39;</span><span class="p">)</span>

<span class="c1"># Make the data directory</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>/Users/elsa/esiil-summit/r_and_py
</code></pre></div>
<p>You should see your username in both paths.</p>
<p>Parameter notes:</p>
<ul>
<li>
<p>In R we get a warning if the directory we’re creating already exists,
  which is suppressed by the <code>showWarnings=F</code> parameter. In Python, it
  is an error unless the <code>exist_ok=True</code> parameter is supplied.</p>
</li>
<li>
<p>In R, we can use the same function to create a single directory and
  multiple nested directories, as long as we use the <code>recursive=T</code>
  parameter. In Python, there is a different <code>os.mkdir()</code> function for
  creating single directories.</p>
</li>
</ul>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: In Python, boolean values are <code>True</code> and <code>False</code>; in
R they are <code>TRUE</code> or <code>T</code> and <code>FALSE</code> or <code>F</code></p>
</blockquote>
<p>Finally, let’s practice copying the data files included in this lesson
to the reproducible data directory:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">project_data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;..&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="nf">path.expand</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;esiil-summit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r_and_py&#39;</span><span class="p">)</span>
<span class="nf">file.copy</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="n">project_data_dir</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="n">recursive</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] TRUE
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="n">project_data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">(),</span> <span class="s1">&#39;esiil-summit&#39;</span><span class="p">,</span> <span class="s1">&#39;r_and_py&#39;</span><span class="p">)</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">project_data_dir</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Error: shutil.Error: Destination path &#39;/Users/elsa/esiil-summit/r_and_py/data&#39; already exists
</code></pre></div>
<blockquote>
<p>Note that Python will not replace an existing directory, so you mush
do only one of these operations (or delete the files)</p>
</blockquote>
<h3 id="getting-tabular-data-to-and-from-text-files">Getting tabular data to and from text files<a class="headerlink" href="#getting-tabular-data-to-and-from-text-files" title="Permanent link">&para;</a></h3>
<p>You can also load data from comma-separated value (<code>.csv</code>) and other
tabular text files.</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>

<span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="nf">path.expand</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;esiil-summit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r_and_py&#39;</span><span class="p">)</span>
<span class="n">penguins_csv_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;penguins.csv&quot;</span><span class="p">)</span>

<span class="n">penguins_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">penguins_csv_path</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>New names:
Rows: 344 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
(3): species, island, sex dbl (6): ...1, bill_length_mm, bill_depth_mm,
flipper_length_mm, body_mass_g...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 344 × 9
    ...1 species island    bill_length_mm bill_depth_mm flipper_length_mm
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
 1     0 Adelie  Torgersen           39.1          18.7               181
 2     1 Adelie  Torgersen           39.5          17.4               186
 3     2 Adelie  Torgersen           40.3          18                 195
 4     3 Adelie  Torgersen           NA            NA                  NA
 5     4 Adelie  Torgersen           36.7          19.3               193
 6     5 Adelie  Torgersen           39.3          20.6               190
 7     6 Adelie  Torgersen           38.9          17.8               181
 8     7 Adelie  Torgersen           39.2          19.6               195
 9     8 Adelie  Torgersen           34.1          18.1               193
10     9 Adelie  Torgersen           42            20.2               190
# ℹ 334 more rows
# ℹ 3 more variables: body_mass_g &lt;dbl&gt;, sex &lt;chr&gt;, year &lt;dbl&gt;
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">penguins_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;penguins.csv&quot;</span><span class="p">)</span>

<span class="n">penguins_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">penguins_csv_path</span><span class="p">)</span>
<span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>     Unnamed: 0    species     island  ...  body_mass_g     sex  year
0             0     Adelie  Torgersen  ...       3750.0    male  2007
1             1     Adelie  Torgersen  ...       3800.0  female  2007
2             2     Adelie  Torgersen  ...       3250.0  female  2007
3             3     Adelie  Torgersen  ...          NaN     NaN  2007
4             4     Adelie  Torgersen  ...       3450.0  female  2007
..          ...        ...        ...  ...          ...     ...   ...
339         339  Chinstrap      Dream  ...       4000.0    male  2009
340         340  Chinstrap      Dream  ...       3400.0  female  2009
341         341  Chinstrap      Dream  ...       3775.0    male  2009
342         342  Chinstrap      Dream  ...       4100.0    male  2009
343         343  Chinstrap      Dream  ...       3775.0  female  2009

[344 rows x 9 columns]
</code></pre></div>
<p>Let’s save that data so if we like we can work offline (and avoid
hitting the server too many times). You can also save your own results
or processed data this way.</p>
<blockquote>
<p>Notice that in R this is a <strong>function</strong> and in Python it is a
<strong>method</strong> of our <code>pd.DataFrame</code> object.</p>
</blockquote>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>

<span class="nf">data</span><span class="p">(</span><span class="s">&#39;iris&#39;</span><span class="p">)</span>

<span class="n">data_dir</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="nf">path.expand</span><span class="p">(</span><span class="s">&#39;~&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;esiil-summit&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r_and_py&#39;</span><span class="p">)</span>

<span class="c1"># Write iris data to CSV</span>
<span class="n">iris_r_csv_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;iris_r.csv&quot;</span><span class="p">)</span>
<span class="nf">write_csv</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="n">iris_r_csv_path</span><span class="p">)</span>
</code></pre></div>

</details>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version &gt;=1.16.5 and &lt;1.23.0 is required for this version of SciPy (detected version 1.23.5
  warnings.warn(f&quot;A NumPy version &gt;={np_minversion} and &lt;{np_maxversion}&quot;
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="n">iris_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>

<span class="c1"># Write iris data to CSV</span>
<span class="n">iris_py_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;iris_py.csv&quot;</span><span class="p">)</span>
<span class="n">iris_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">iris_py_csv_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

</details>

<blockquote>
<p><strong>GOTCHA ALERT</strong>: The pandas <code>pd.DataFrame.to_csv()</code> method is not
<em>quite</em> symmetrical with <code>pd.read_csv()</code>. This is because pandas
<code>DataFrame</code>s have an <strong>index</strong>, or row identifier, and you need to
choose how to deal with it when reading and writing files. Since in
this case the index is simply a row number and not critical
information, we’ve solved this problem by eliminating the index
altogether in the file using the <code>index=False</code> parameter. Go ahead and
try removing it to see what happens when we reload!</p>
</blockquote>
<p>You can also load data from comma-separated value (<code>.csv</code>) and other
tabular text files.</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>

<span class="n">penguins_csv_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;penguins.csv&quot;</span><span class="p">)</span>

<span class="n">penguins_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">penguins_csv_path</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>New names:
Rows: 344 Columns: 9
── Column specification
──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
(3): species, island, sex dbl (6): ...1, bill_length_mm, bill_depth_mm,
flipper_length_mm, body_mass_g...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 344 × 9
    ...1 species island    bill_length_mm bill_depth_mm flipper_length_mm
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
 1     0 Adelie  Torgersen           39.1          18.7               181
 2     1 Adelie  Torgersen           39.5          17.4               186
 3     2 Adelie  Torgersen           40.3          18                 195
 4     3 Adelie  Torgersen           NA            NA                  NA
 5     4 Adelie  Torgersen           36.7          19.3               193
 6     5 Adelie  Torgersen           39.3          20.6               190
 7     6 Adelie  Torgersen           38.9          17.8               181
 8     7 Adelie  Torgersen           39.2          19.6               195
 9     8 Adelie  Torgersen           34.1          18.1               193
10     9 Adelie  Torgersen           42            20.2               190
# ℹ 334 more rows
# ℹ 3 more variables: body_mass_g &lt;dbl&gt;, sex &lt;chr&gt;, year &lt;dbl&gt;
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">penguins_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;penguins.csv&quot;</span><span class="p">)</span>

<span class="n">penguins_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">penguins_csv_path</span><span class="p">)</span>
<span class="n">penguins_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>     Unnamed: 0    species     island  ...  body_mass_g     sex  year
0             0     Adelie  Torgersen  ...       3750.0    male  2007
1             1     Adelie  Torgersen  ...       3800.0  female  2007
2             2     Adelie  Torgersen  ...       3250.0  female  2007
3             3     Adelie  Torgersen  ...          NaN     NaN  2007
4             4     Adelie  Torgersen  ...       3450.0  female  2007
..          ...        ...        ...  ...          ...     ...   ...
339         339  Chinstrap      Dream  ...       4000.0    male  2009
340         340  Chinstrap      Dream  ...       3400.0  female  2009
341         341  Chinstrap      Dream  ...       3775.0    male  2009
342         342  Chinstrap      Dream  ...       4100.0    male  2009
343         343  Chinstrap      Dream  ...       3775.0  female  2009

[344 rows x 9 columns]
</code></pre></div>
<h3 id="serialize-data">Serialize data<a class="headerlink" href="#serialize-data" title="Permanent link">&para;</a></h3>
<p>In both Python and R, you can also <strong>serialize</strong> objects so they can be
read back into the environment quickly (but aren’t easily readable by
other programming languages).</p>
<blockquote>
<p><strong>Why serialize?</strong> This can be a great option when you want to cache
intermediate analysis results, long downloads, or if you need to send
objects from one worker to another in a multiprocessing context.</p>
</blockquote>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">penguins_rds_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;penguins.rds&quot;</span><span class="p">)</span>

<span class="c1"># Serialize penguin data</span>
<span class="nf">saveRDS</span><span class="p">(</span><span class="n">penguins_df</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="o">=</span><span class="n">penguins_rds_path</span><span class="p">)</span>
</code></pre></div>

</details>

<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="n">penguins_pickle_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;penguins.pickle&quot;</span><span class="p">)</span>

<span class="c1"># Serialize penguins data</span>
<span class="n">penguins_df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">penguins_pickle_path</span><span class="p">)</span>
</code></pre></div>

</details>

<p>Go ahead and take a look at those files to see what they look like! One
way to do so is by using a terminal and the command
<code>head /path/to/penguins/file</code>.</p>
<h3 id="load-serialized-data">Load serialized data<a class="headerlink" href="#load-serialized-data" title="Permanent link">&para;</a></h3>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="n">penguins_rds_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;penguins.rds&quot;</span><span class="p">)</span>

<span class="c1"># Unserialize penguin data</span>
<span class="n">penguins_from_serial_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">readRDS</span><span class="p">(</span><span class="n">penguins_rds_path</span><span class="p">)</span>
<span class="n">penguins_from_serial_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 344 × 9
    ...1 species island    bill_length_mm bill_depth_mm flipper_length_mm
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
 1     0 Adelie  Torgersen           39.1          18.7               181
 2     1 Adelie  Torgersen           39.5          17.4               186
 3     2 Adelie  Torgersen           40.3          18                 195
 4     3 Adelie  Torgersen           NA            NA                  NA
 5     4 Adelie  Torgersen           36.7          19.3               193
 6     5 Adelie  Torgersen           39.3          20.6               190
 7     6 Adelie  Torgersen           38.9          17.8               181
 8     7 Adelie  Torgersen           39.2          19.6               195
 9     8 Adelie  Torgersen           34.1          18.1               193
10     9 Adelie  Torgersen           42            20.2               190
# ℹ 334 more rows
# ℹ 3 more variables: body_mass_g &lt;dbl&gt;, sex &lt;chr&gt;, year &lt;dbl&gt;
</code></pre></div>
<p>In R, there are a number of slightly different functions for serializing
data. For example, you can check out base R <code>save()</code> and <code>load()</code>
functions as well if you need to save multiple objects (or a whole
environment) at once.</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">penguins_pickle_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;penguins.pickle&quot;</span><span class="p">)</span>

<span class="c1"># Unserialize penguin data</span>
<span class="n">penguins_from_serial_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">penguins_pickle_path</span><span class="p">)</span>
<span class="n">penguins_from_serial_df</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>     Unnamed: 0    species     island  ...  body_mass_g     sex  year
0             0     Adelie  Torgersen  ...       3750.0    male  2007
1             1     Adelie  Torgersen  ...       3800.0  female  2007
2             2     Adelie  Torgersen  ...       3250.0  female  2007
3             3     Adelie  Torgersen  ...          NaN     NaN  2007
4             4     Adelie  Torgersen  ...       3450.0  female  2007
..          ...        ...        ...  ...          ...     ...   ...
339         339  Chinstrap      Dream  ...       4000.0    male  2009
340         340  Chinstrap      Dream  ...       3400.0  female  2009
341         341  Chinstrap      Dream  ...       3775.0    male  2009
342         342  Chinstrap      Dream  ...       4100.0    male  2009
343         343  Chinstrap      Dream  ...       3775.0  female  2009

[344 rows x 9 columns]
</code></pre></div>
<p>You can also use the <code>pickle</code> library to pickle objects in Python. In
this case, the <code>pd.DataFrame</code> method for pickling takes care of some of
the details for us (as long as we’re working only with <code>pandas</code>
objects).</p>
<h2 id="data-plots">Data Plots<a class="headerlink" href="#data-plots" title="Permanent link">&para;</a></h2>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Plot the penguin data</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">penguins_df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bill_length_mm</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body_mass_g</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># Create a scatter plot of the data</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># Label the plot</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Bill Length (mm)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Body Mass (g)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Species&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># Add a title</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#39;Penguin Characteristics by Species&#39;</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Warning: Removed 2 rows containing missing values (`geom_point()`).
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-36-1.png" /></p>
<p>Python seaborn.objects code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">seaborn.objects</span> <span class="k">as</span> <span class="nn">so</span>
<span class="c1"># Make a scatter plot with the penguin data</span>
<span class="p">(</span>
    <span class="n">so</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">penguins_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;body_mass_g&#39;</span><span class="p">)</span>
    <span class="c1"># Make a scatter plot colored by species</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Dot</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">)</span>
    <span class="c1"># Add labels</span>
    <span class="o">.</span><span class="n">label</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Bill Length (mm)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Body Mass (g)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Species&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Penguin Characteristics by Species&#39;</span><span class="p">)</span>
    <span class="c1"># Give the legend some more room so it doesn&#39;t overlap the data</span>
    <span class="o">.</span><span class="n">layout</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>
    <span class="c1"># Display the plot</span>
    <span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
  self[key] = other[key]
/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
  self[key] = other[key]
/Users/elsa/Library/Caches/org.R-project.R/R/renv/cache/v5/R-4.3/x86_64-apple-darwin20/reticulate/1.28/86c441bf33e1d608db773cb94b848458/reticulate/python/rpytools/call.py:10: UserWarning: There are no gridspecs with layoutgrids. Possibly did not call parent GridSpec with the &quot;figure&quot; keyword
  value, error = rpycall.call_r_function(f, *args, **kwargs)
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-37-1.png" /></p>
<blockquote>
<p><strong>GOTCHA ALERT:</strong> In Python, you will usually need to put <code>.show()</code> or
something similar at the end of your code to see your plot. Otherwise
you may see something like:</p>
<div class="highlight"><pre><span></span><code>&lt;seaborn._core.plot.Plot object at 0x7f81493e4070&gt;
</code></pre></div>
</blockquote>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="n">ggplot</span><span class="p">,</span> <span class="n">aes</span><span class="p">,</span> <span class="n">geom_point</span><span class="p">,</span> <span class="n">labs</span><span class="p">,</span> <span class="n">theme</span><span class="p">,</span> <span class="n">ggtitle</span>

<span class="c1"># Plot the penguin data</span>
<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">penguins_df</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;bill_length_mm&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;body_mass_g&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">))</span>
    <span class="c1"># Create a scatter plot of the data</span>
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">()</span>
    <span class="c1"># For some reason the legend gets cut off</span>
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">subplots_adjust</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
    <span class="c1"># Label the plot</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Bill Length (mm)&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Body Mass (g)&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;Species&#39;</span><span class="p">)</span>
    <span class="c1"># Add a title</span>
    <span class="o">+</span> <span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Penguin Characteristics by Species&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>&lt;ggplot: (8778956226557)&gt;

/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/site-packages/plotnine/layer.py:401: PlotnineWarning: geom_point : Removed 2 rows containing missing values.
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-38-1.png" /></p>
<blockquote>
<p><strong>GOTCHA ALERT:</strong> If you are used to <code>ggplot2</code> and are using
<code>plotnine</code>, there are a few things to be aware of. One is that
<a href="https://adv-r.hadley.nz/quasiquotation.html">quasiquotation</a> allows
you to leave quotes out of your <code>ggplot2</code> code. There is no equivalent
in Python - you must use quotes on column names and anything else that
isn’t a defined name in your environment!</p>
<p>You also must surround the code for plotting with parentheses to get
the <code>+</code> syntax for layers to work in Python.</p>
<p>Finally, we had some display problems had to adjust the plot theme to
see the legend. You may or may not have this problem depending on your
coding environment</p>
</blockquote>
<p>In both cases, we generate some sample data and create a scatter plot to
visualize the relationship between the variables.</p>
<p>Some notes on plotting packages:</p>
<ul>
<li>
<p>In R, although there is a built-in <code>base</code> plotting functionality, the
  <code>ggplot2</code> package is overwhelmingly used for static plotting. <code>gg</code>
  stands for Grammar of Graphics, and is an intuitive interface for
  making plots that convey the information you want.</p>
</li>
<li>
<p>In Python, there are many options, nearly all of them based on either
  the Matlab-inspired <code>matplotlib</code>. <code>matplotlib</code> gives you a lot of
  control over your plot, but on the downside you <em>have</em> to control
  nearly everything about your plot. We recommend the <code>seaborn.objects</code>
  or <code>so</code> interface used above, though it is relatively new, because it
  is a flexible and powerful interface that does not require you to
  learn any <code>matplotlib</code>. You can also plot with nearly identical syntax
  to <code>ggplot2</code> using the <code>plotnine</code> library.</p>
</li>
<li>
<p>For making interactive plots, the go-to libraries are typically based
  on Javascript and available in both R and Python. Some popular options
  are: <code>plotly</code>, <code>leaflet</code> (R) or <code>folium</code> (Python), and <code>bokeh</code>.</p>
</li>
</ul>
<h2 id="piping-and-chaining">Piping and Chaining<a class="headerlink" href="#piping-and-chaining" title="Permanent link">&para;</a></h2>
<p>Piping is a powerful feature in R that allows for a more streamlined and
readable code. In Python, you can code in a similar style using a
process called method chaining.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: As the name implies, to use method chaining you need
to be using a method of the object you’re working with. There is a
.pipe() method of pd.DataFrames that that allows you to use method
chaining with functions that you wrote or imported.</p>
<p><strong>GOTCHA ALERT</strong>: Though code pipelines can be easier to read, they
can be harder to debug. If you get an error in an R pipeline, you may
not get the information you need about where that error occurred. You
can avoid problems by testing your pipelines one line at a time.</p>
</blockquote>
<p>The syntax for piping is different from method chaining. In R, piping is
done using the %&gt;% operator from the magrittr package. In Python,
method chaining is done by applying methods to the results of previous
methods, using that dot . again, making sure to surround the whole
statement with parentheses so you can format it nicely. Both of these
operators have the effect of taking whatever object is before them (on
the left) and making it the first argument in the next function/method.</p>
<p>R code without pipes:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Create a data frame</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>

<span class="c1"># Calculate the sum of x and y and the take the sum of the new column z</span>
<span class="nf">summarize</span><span class="p">(</span><span class="nf">mutate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">sum_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>  sum_z
1    21
</code></pre></div>
<p>R code with piping:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Create a data frame</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">))</span>


<span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># Calculate the vector sum of column x and y</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># Calculate the sum of the new column z</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">sum_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>  sum_z
1    21
</code></pre></div>
<p>Python code without chaining:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># create a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]})</span>

<span class="c1"># Calculate the sum of column x and y</span>
<span class="n">df_with_sum</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Calculate the sum of the new column z</span>
<span class="n">df_with_sum</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_z</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>        z
sum_z  21
</code></pre></div>
<p>Python code with chaining:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]})</span>

<span class="p">(</span>
    <span class="n">df</span>
    <span class="c1"># Calculate the sum of column x and y</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="c1"># Calculate the sum o the new column z</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">sum_z</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>        z
sum_z  21
</code></pre></div>
<p>As we can see, the syntax for piping is slightly different between R and
Python, but the concept remains the same. Piping can make our code more
readable and easier to follow, which is an important aspect of creating
efficient and effective code. It avoids obtuse many-layer nested
functions and also keeping lots of intermediate processing steps in
memory as variables.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="nf">data</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;setosa&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarise</span><span class="p">(</span><span class="n">mean.Petal.Length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">Petal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">Sepal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean.Petal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;identity&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dodgerblue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Mean Petal Length of Setosa by Sepal Width&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sepal Width&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Mean Petal Length&quot;</span><span class="p">)</span>
</code></pre></div>

</details>

<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-43-1.png" /></p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">iris_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">iris_df</span>
    <span class="p">[</span><span class="n">iris_df</span><span class="o">.</span><span class="n">species</span><span class="o">==</span><span class="s1">&#39;setosa&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_petal_length</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Mean Petal Length of Petals by Sepal Width&#39;</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Sepal Width&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_petal_length&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Mean Petal Length&#39;</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>

<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-44-3.png" /></p>
<h2 id="linear-regression">Linear regression<a class="headerlink" href="#linear-regression" title="Permanent link">&para;</a></h2>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Load the &quot;ggplot2&quot; package for plotting</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Get some sample data</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;faithful&#39;</span><span class="p">)</span>
<span class="n">faithful</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>    eruptions waiting
1       3.600      79
2       1.800      54
3       3.333      74
4       2.283      62
5       4.533      85
6       2.883      55
7       4.700      88
8       3.600      85
9       1.950      51
10      4.350      85
11      1.833      54
12      3.917      84
13      4.200      78
14      1.750      47
15      4.700      83
16      2.167      52
17      1.750      62
18      4.800      84
19      1.600      52
20      4.250      79
21      1.800      51
22      1.750      47
23      3.450      78
24      3.067      69
25      4.533      74
26      3.600      83
27      1.967      55
28      4.083      76
29      3.850      78
30      4.433      79
31      4.300      73
32      4.467      77
33      3.367      66
34      4.033      80
35      3.833      74
36      2.017      52
37      1.867      48
38      4.833      80
39      1.833      59
40      4.783      90
41      4.350      80
42      1.883      58
43      4.567      84
44      1.750      58
45      4.533      73
46      3.317      83
47      3.833      64
48      2.100      53
49      4.633      82
50      2.000      59
51      4.800      75
52      4.716      90
53      1.833      54
54      4.833      80
55      1.733      54
56      4.883      83
57      3.717      71
58      1.667      64
59      4.567      77
60      4.317      81
61      2.233      59
62      4.500      84
63      1.750      48
64      4.800      82
65      1.817      60
66      4.400      92
67      4.167      78
68      4.700      78
69      2.067      65
70      4.700      73
71      4.033      82
72      1.967      56
73      4.500      79
74      4.000      71
75      1.983      62
76      5.067      76
77      2.017      60
78      4.567      78
79      3.883      76
80      3.600      83
81      4.133      75
82      4.333      82
83      4.100      70
84      2.633      65
85      4.067      73
86      4.933      88
87      3.950      76
88      4.517      80
89      2.167      48
90      4.000      86
91      2.200      60
92      4.333      90
93      1.867      50
94      4.817      78
95      1.833      63
96      4.300      72
97      4.667      84
98      3.750      75
99      1.867      51
100     4.900      82
101     2.483      62
102     4.367      88
103     2.100      49
104     4.500      83
105     4.050      81
106     1.867      47
107     4.700      84
108     1.783      52
109     4.850      86
110     3.683      81
111     4.733      75
112     2.300      59
113     4.900      89
114     4.417      79
115     1.700      59
116     4.633      81
117     2.317      50
118     4.600      85
119     1.817      59
120     4.417      87
121     2.617      53
122     4.067      69
123     4.250      77
124     1.967      56
125     4.600      88
126     3.767      81
127     1.917      45
128     4.500      82
129     2.267      55
130     4.650      90
131     1.867      45
132     4.167      83
133     2.800      56
134     4.333      89
135     1.833      46
136     4.383      82
137     1.883      51
138     4.933      86
139     2.033      53
140     3.733      79
141     4.233      81
142     2.233      60
143     4.533      82
144     4.817      77
145     4.333      76
146     1.983      59
147     4.633      80
148     2.017      49
149     5.100      96
150     1.800      53
151     5.033      77
152     4.000      77
153     2.400      65
154     4.600      81
155     3.567      71
156     4.000      70
157     4.500      81
158     4.083      93
159     1.800      53
160     3.967      89
161     2.200      45
162     4.150      86
163     2.000      58
164     3.833      78
165     3.500      66
166     4.583      76
167     2.367      63
168     5.000      88
169     1.933      52
170     4.617      93
171     1.917      49
172     2.083      57
173     4.583      77
174     3.333      68
175     4.167      81
176     4.333      81
177     4.500      73
178     2.417      50
179     4.000      85
180     4.167      74
181     1.883      55
182     4.583      77
183     4.250      83
184     3.767      83
185     2.033      51
186     4.433      78
187     4.083      84
188     1.833      46
189     4.417      83
190     2.183      55
191     4.800      81
192     1.833      57
193     4.800      76
194     4.100      84
195     3.966      77
196     4.233      81
197     3.500      87
198     4.366      77
199     2.250      51
200     4.667      78
201     2.100      60
202     4.350      82
203     4.133      91
204     1.867      53
205     4.600      78
206     1.783      46
207     4.367      77
208     3.850      84
209     1.933      49
210     4.500      83
211     2.383      71
212     4.700      80
213     1.867      49
214     3.833      75
215     3.417      64
216     4.233      76
217     2.400      53
218     4.800      94
219     2.000      55
220     4.150      76
221     1.867      50
222     4.267      82
223     1.750      54
224     4.483      75
225     4.000      78
226     4.117      79
227     4.083      78
228     4.267      78
229     3.917      70
230     4.550      79
231     4.083      70
232     2.417      54
233     4.183      86
234     2.217      50
235     4.450      90
236     1.883      54
237     1.850      54
238     4.283      77
239     3.950      79
240     2.333      64
241     4.150      75
242     2.350      47
243     4.933      86
244     2.900      63
245     4.583      85
246     3.833      82
247     2.083      57
248     4.367      82
249     2.133      67
250     4.350      74
251     2.200      54
252     4.450      83
253     3.567      73
254     4.500      73
255     4.150      88
256     3.817      80
257     3.917      71
258     4.450      83
259     2.000      56
260     4.283      79
261     4.767      78
262     4.533      84
263     1.850      58
264     4.250      83
265     1.983      43
266     2.250      60
267     4.750      75
268     4.117      81
269     2.150      46
270     4.417      90
271     1.817      46
272     4.467      74
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Perform linear regression</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">waiting</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">eruptions</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">faithful</span><span class="p">)</span>

<span class="c1"># Print the model summary</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Call:
lm(formula = waiting ~ eruptions, data = faithful)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.0796  -4.4831   0.2122   3.9246  15.9719

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  33.4744     1.1549   28.98   &lt;2e-16 ***
eruptions    10.7296     0.3148   34.09   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 5.914 on 270 degrees of freedom
Multiple R-squared:  0.8115,    Adjusted R-squared:  0.8108 
F-statistic:  1162 on 1 and 270 DF,  p-value: &lt; 2.2e-16
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Plot the data and regression line</span>
<span class="n">faithful</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eruptions</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">waiting</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># Training data</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># Linear regression</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Eruption Duration (min.)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Waiting Time to Next Eruption (min.)&#39;</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>`geom_smooth()` using formula = &#39;y ~ x&#39;
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-45-3.png" /></p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">seaborn.objects</span> <span class="k">as</span> <span class="nn">so</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">faithful_df</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;geyser&#39;</span><span class="p">)</span>

<span class="c1"># Perform linear regression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;waiting ~ duration&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">faithful_df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Print the model summary</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="c1"># Plot the data with a regression line</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                waiting   R-squared:                       0.811
Model:                            OLS   Adj. R-squared:                  0.811
Method:                 Least Squares   F-statistic:                     1162.
Date:                Thu, 18 May 2023   Prob (F-statistic):          8.13e-100
Time:                        12:06:55   Log-Likelihood:                -868.38
No. Observations:                 272   AIC:                             1741.
Df Residuals:                     270   BIC:                             1748.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     33.4744      1.155     28.985      0.000      31.201      35.748
duration      10.7296      0.315     34.089      0.000      10.110      11.349
==============================================================================
Omnibus:                        5.492   Durbin-Watson:                   2.543
Prob(Omnibus):                  0.064   Jarque-Bera (JB):                4.683
Skew:                           0.237   Prob(JB):                       0.0962
Kurtosis:                       2.567   Cond. No.                         12.6
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="n">so</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">faithful_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;duration&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;waiting&#39;</span><span class="p">)</span>
    <span class="c1"># Training data</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Dots</span><span class="p">())</span>
    <span class="c1"># Linear regression</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">so</span><span class="o">.</span><span class="n">PolyFit</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Eruption Duration (min.)&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Waiting Time to Next Eruption (min.)&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-46-5.png" /></p>
<p>In both cases, we generate some sample data with a linear relationship
between x and y, and then perform a simple linear regression to estimate
the slope and intercept of the line. We then plot the data and
regression line to visualize the fit.</p>
<p>There are a few differences in the syntax and functionality between the
two approaches:</p>
<ul>
<li>Library and package names: In R, we use the <code>lm()</code> function from the
  <code>base</code> package to perform linear regression, while in Python, we use
  the <code>olm()</code> function from the <code>statsmodels</code> library.</li>
</ul>
<h2 id="random-forest">Random Forest<a class="headerlink" href="#random-forest" title="Permanent link">&para;</a></h2>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Load the &quot;randomForest&quot; package</span>
<span class="nf">library</span><span class="p">(</span><span class="n">randomForest</span><span class="p">)</span>

<span class="c1"># Load the &quot;iris&quot; dataset</span>
<span class="nf">data</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">train_idx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">iris</span><span class="p">),</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">train_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="p">[</span><span class="n">train_idx</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
<span class="n">test_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iris</span><span class="p">[</span><span class="o">-</span><span class="n">train_idx</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>

<span class="c1"># Build a random forest model</span>
<span class="n">rf_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">randomForest</span><span class="p">(</span><span class="n">Species</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_data</span><span class="p">,</span><span class="w"> </span><span class="n">ntree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span>

<span class="c1"># Make predictions on the testing set</span>
<span class="n">predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">rf_model</span><span class="p">,</span><span class="w"> </span><span class="n">test_data</span><span class="p">)</span>

<span class="c1"># Calculate accuracy of the model</span>
<span class="n">accuracy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">predictions</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">test_data</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Accuracy:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accuracy</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Accuracy: 0.977777777777778&quot;
</code></pre></div>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn.objects</span> <span class="k">as</span> <span class="nn">so</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">permutation_importance</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Load the &quot;iris&quot; dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Build a random forest model</span>
<span class="n">rf_model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rf_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Make predictions on the testing set</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>RandomForestClassifier(n_estimators=500, oob_score=True, random_state=123)
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="n">predictions</span> <span class="o">=</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># OOB score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;OOB score: &#39;</span><span class="p">,</span> <span class="n">rf_model</span><span class="o">.</span><span class="n">oob_score_</span><span class="p">)</span>

<span class="c1"># Accuracy on test data</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>OOB score:  0.9428571428571428
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="n">accuracy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

<span class="c1"># Confusion Matrix</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Accuracy: 0.9555555555555556
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>

<span class="c1"># Plot feature permutation importances</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[[18  0  0]
 [ 0 10  0]
 [ 0  2 15]]
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="n">importances</span> <span class="o">=</span> <span class="n">permutation_importance</span><span class="p">(</span>
    <span class="n">rf_model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="p">(</span>
    <span class="n">so</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">importances</span><span class="o">.</span><span class="n">importances_mean</span><span class="p">,</span> 
                <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span>
            <span class="p">}</span>
        <span class="p">),</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;feature&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;importance&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Bar</span><span class="p">())</span>
    <span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Permutation Importance&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
/Users/elsa/opt/miniconda3/envs/earth-analytics-python/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: 
The savefig.jpeg_quality rcparam was deprecated in Matplotlib 3.3 and will be removed two minor releases later.
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-48-7.png" /></p>
<p>In both cases, we load the iris dataset and split it into training and
testing sets. We then build a random forest model using the training
data and evaluate its accuracy on the testing data.</p>
<p>There are a few differences in the syntax and functionality between the
two approaches:</p>
<ul>
<li>Library and package names: In R, we use the randomForest package to
  build random forest models, while in Python, we use the
  RandomForestClassifier class from the sklearn.ensemble module. We also
  use different libraries for loading and manipulating data (pandas and
  numpy in Python, and built-in datasets in R). Model parameters: The
  syntax for setting model parameters is slightly different in R and
  Python. For example, in R, we specify the number of trees using the
  ntree parameter, while in Python, we use the n_estimators parameter.
  Data format: In R, we use a data frame to store the input data, while
  in Python, we use numpy arrays.</li>
</ul>
<h2 id="basic-streetmap-from-open-street-map">Basic streetmap from Open Street Map<a class="headerlink" href="#basic-streetmap-from-open-street-map" title="Permanent link">&para;</a></h2>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Load the &quot;osmdata&quot; package for mapping</span>
<span class="nf">library</span><span class="p">(</span><span class="n">osmdata</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tmap</span><span class="p">)</span>

<span class="c1"># Define the map bounding box</span>
<span class="n">bbox</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.16</span><span class="p">,</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">51.49</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.13</span><span class="p">,</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">51.51</span><span class="p">)</span>

<span class="c1"># Get the OpenStreetMap data</span>
<span class="n">osm_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">opq</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">add_osm_feature</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;highway&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">osmdata_sf</span><span class="p">()</span>

<span class="c1"># Plot the map using tmap</span>
<span class="nf">tm_shape</span><span class="p">(</span><span class="n">osm_data</span><span class="o">$</span><span class="n">osm_lines</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">tm_lines</span><span class="p">()</span>
</code></pre></div>

</details>

<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-49-3.png" /></p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Load the &quot;osmnx&quot; package for mapping</span>
<span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>

<span class="c1"># Define the map bounding box</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;south&#39;</span><span class="p">:</span> <span class="mf">51.49</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">:</span> <span class="mf">51.51</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.13</span><span class="p">}</span>

<span class="c1"># Get the OpenStreetMap data</span>
<span class="n">osm_graph</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">graph_from_bbox</span><span class="p">(</span><span class="o">**</span><span class="n">bbox</span><span class="p">)</span>

<span class="c1"># Plot the map using osmnx</span>
<span class="n">ox</span><span class="o">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">osm_graph</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>(&lt;Figure size 800x800 with 0 Axes&gt;, &lt;AxesSubplot:&gt;)
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-50-1.png" /></p>
<p>In both cases, we define the map bounding box, retrieve the
OpenStreetMap data using the specified bounding box, and plot the map.</p>
<p>The main differences between the two approaches are:</p>
<ul>
<li>
<p>Package names and syntax: In R, we use the osmdata package and its
  syntax to download and process the OpenStreetMap data, while in
  Python, we use the osmnx package and its syntax. We also could have
  access the OSM API directly, but these packages make it convenient to
  get boundaries and roads with only a few lines of code.</p>
</li>
<li>
<p>Mapping libraries: In R, we use the tmap package to create a static
  map of the OpenStreetMap data, while in Python, we use the built-in
  ox.plot_graph function from the osmnx package to plot the map.</p>
</li>
<li>
<p>In both Python and R, we define the bounding box as new type of object
  (for this notebook). In R, we use a named vector; in Python, we use a
  dictionary. There are some (very) subtle differences between the
  implementation of these objects, but for now we can treat them as the
  same. Using <strong>named</strong> formats for data like named vectors,
  dictionaries, and dataframes help us to write clean and readable code.
  For example, in this case each coordinate could be either latitude or
  longitude and the names help distinguish that.</p>
</li>
</ul>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: In Python, asterisks are not only used for
multiplication like in R. As in the code above, we can use a single
asterisk before a list to <strong>unpack</strong> it (provide each element
separately), or a double asterisk to <strong>unpack</strong> a dictionary.</p>
</blockquote>
<h2 id="for-loops">for loops<a class="headerlink" href="#for-loops" title="Permanent link">&para;</a></h2>
<p>Here is an example of a for loop in R:</p>
<p>R code</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Create a vector of numbers</span>
<span class="n">numbers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>

<span class="c1"># Use a for loop to print out each number in the vector</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">numbers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
</code></pre></div>
<p>In this example, the for loop iterates over each element in the numbers
vector, assigning the current element to the variable <code>i</code>. The
<code>print(i)</code> function is then executed for each iteration, outputting the
value of <code>i</code>.</p>
<p>Here is the equivalent example in Python:</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Create a list of numbers</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Use a for loop to print out each number in the list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>1
2
3
4
5
</code></pre></div>
<p>Both languages also support nested for loops, which can be used to
perform iterations over multiple dimensions, such as looping through a
2D array.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: In both R and Python, the <strong>looping variable</strong> (in
this case <code>i</code>) is created by the <code>for</code> loop, which is why you can use
it even though you didn’t define it. However, <code>i</code> is not deleted after
the <code>for</code> loop! Be careful about using <strong>looping variables</strong> with the
same name as other variables in your code, because they can write over
each other - we recommend not reusing the same variable within the
same notebook as you get started.</p>
<p><strong>GOTCHA ALERT</strong>: In both Python and R, <code>for</code> loops are not generally
the most efficient way of dealing with large arrays. Instead, use
built-in <strong>vectorized</strong> functions in R and the <code>numpy</code> package in
Python to take advantage of optimized linear algebra libraries.</p>
</blockquote>
<h2 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h2>
<p>Both R and Python are powerful languages for writing functions that can
take input, perform a specific task, and return output.</p>
<p>R Code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Define a function that takes two arguments and returns their sum</span>
<span class="n">sum_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Call the function with two arguments and print the result</span>
<span class="n">result_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum_r</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">result_r</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] 8
</code></pre></div>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Define a function that takes two arguments and returns their sum</span>
<span class="k">def</span> <span class="nf">sum_py</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># Call the function with two arguments and print the result</span>
<span class="n">result_py</span> <span class="o">=</span> <span class="n">sum_py</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_py</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>8
</code></pre></div>
<p>In both cases, we define a function that takes two arguments and returns
their sum. In R, we use the function keyword to define a function, while
in Python, we use the def keyword. The function body in R is enclosed in
curly braces, while in Python it is indented.</p>
<p>There are a few differences in the syntax and functionality between the
two approaches:</p>
<ul>
<li>
<p>Function arguments: In R, function arguments are separated by commas,
  while in Python they are enclosed in parentheses. The syntax for
  specifying default arguments and variable-length argument lists can
  also differ between the two languages.</p>
</li>
<li>
<p>Return: In R, <code>return()</code> is a function that needs parentheses. In
  Python, it is a keyword, and so no parenthesed are used. This type of
  syntax in Python is called a <strong>statement</strong>.</p>
</li>
<li>
<p>Function names: In R there is a convention of using dots <code>.</code> instead
  of underscores in function and variable names. This is impossible in
  Python because of the nature of the dot <code>.</code> special character in
  Python.</p>
</li>
</ul>
<h2 id="parallel">Parallel<a class="headerlink" href="#parallel" title="Permanent link">&para;</a></h2>
<p>Parallel computing is a technique used to execute multiple computational
tasks simultaneously, which can significantly reduce the time or memory
required to complete a task. In earth science, we are more often limited
by memory than processing capability (CPUs) because we tend to perform
simple operations on lots of spatial data, and parallel computing can
help split up a problem so it <strong>takes longer but runs with less
memory</strong>. However, cloud infrastructure with GPUs that are designed for
images and ample memory could change the balance there.</p>
<p>In general, when we talk about parallel computing, we mean something
called <strong>embarrassingly parallel</strong> problems. Essentially, that means
that we can split up our data into roughly equal chunks, perform our
operation on all the chunks (which should take roughly the same amount
of time), and then recombine – all without the parallel tasks needing to
communicate with each other. There are tools, such as the <a href="https://www.open-mpi.org/">Message
Passing Interface (openmpi</a>) that can be used
with either programming language for more complex parallelization tasks.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: It’s a common misconception that parallelizing code
can magically speed up code. In reality, using code that takes
advantage of (blazingly fast) basic linear algebra libraries can speed
up code more than parallelizing a (much) slower method. In addition,
creating parallel tasks requires some <strong>overhead</strong> - time to split up
data and start the processes. Be prepared to experiment with the
number and types of tasks if you truly want to optimize your code for
a particular system. On the other hand - often you can just find a
bigger computer, especially if you make friends with the Cyverse folks
;)</p>
</blockquote>
<p>Both R and Python have built-in support for parallel computing. In this
answer, we will introduce you to some options in each language.</p>
<h3 id="parallel-computing-in-r">Parallel computing in R<a class="headerlink" href="#parallel-computing-in-r" title="Permanent link">&para;</a></h3>
<p>In R, there are several packages that support parallel computing, such
as parallel, foreach, and doParallel. The parallel package provides
basic functionality for parallel computing, while foreach and doParallel
provide higher-level abstractions that make it easier to write parallel
code.</p>
<p>Here is an example of using the <code>foreach</code> and <code>doParallel</code> packages to
execute a loop in parallel. Notice that there are two steps here -
setting up the cluster with certain parameters (in this case we ask for
4 tasks), and then running a <code>for</code> loop substitute that takes advantage
of the cluster.:</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">foreach</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">doParallel</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Loading required package: iterators

Loading required package: parallel
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Define a function to apply in parallel</span>
<span class="n">myfunc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># some computation here</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Generate some data</span>
<span class="n">mydata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">100</span>

<span class="c1"># Apply the function in series</span>
<span class="n">single_start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">mydata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">#Sys.sleep(.1)</span>
<span class="w">  </span><span class="nf">append</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Calculate rough wall time</span>
<span class="n">single_time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">single_start</span>

<span class="c1"># Time vectorized</span>
<span class="n">vector_start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span>
<span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">mydata</span><span class="p">,</span><span class="w"> </span><span class="n">myfunc</span><span class="p">)</span>
<span class="n">vector_time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">single_start</span>

<span class="n">cluster_start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span>
<span class="c1"># Set up a parallel backend with 4 workers</span>
<span class="n">cl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">makeCluster</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
<span class="nf">registerDoParallel</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>

<span class="c1"># Apply the function to the data in parallel</span>
<span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">foreach</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mydata</span><span class="p">)</span><span class="w"> </span><span class="o">%dopar%</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">myfunc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Stop the cluster</span>
<span class="nf">stopCluster</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>

<span class="c1"># Calculate rough wall time</span>
<span class="n">cluster_time</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cluster_start</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Time without cluster: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">single_time</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Time without cluster:  0.014976978302002&quot;
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Time vectorized: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">vector_time</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Time vectorized:  0.0239660739898682&quot;
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Time with cluster: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">cluster_time</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Time with cluster:  0.632711172103882&quot;
</code></pre></div>
<p>Oops! Our parallel version takes <strong>more</strong> time. Let’s try making our
function take longer, to simulate what happens in a more complex
situation. Uncomment the <code>Sys.sleep(.1)</code> line in <code>myfunc</code> above and run
again. In this case, the vectorized version is slightly slower that the
<code>for</code> loop, but that is probably not universally true!</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: This <code>foreach</code> method creates a <strong>new task for every
number</strong>. Go ahead and try increasing to 100000 numbers. That’s not a
very efficient way to work with large lists because of the overhead
required to make each process. We’d rather use a technique that would
split the numbers into larger <strong>chunks</strong>.</p>
</blockquote>
<p>In this example, we:</p>
<ol>
<li>use the makeCluster() function to set up a cluster with 4 workers</li>
<li>registerDoParallel() function to register the cluster as the
    parallel backend for foreach</li>
<li>define a function myfunc() that takes an input x and returns x^2.</li>
<li>generate some data</li>
<li>use foreach to apply myfunc() to each element of mydata in parallel,
    using the %dopar% operator to tell R to use the cluster we set up
    earlier.</li>
<li>Close the cluster - this prevents the code from continuing to use
    unnecessary overhead</li>
</ol>
<h3 id="r-tidyverse-parallel">R Tidyverse parallel<a class="headerlink" href="#r-tidyverse-parallel" title="Permanent link">&para;</a></h3>
<p>In R Tidyverse, we can use the furrr package for parallel computing.
Here’s an example of using furrr to parallelize a map function:</p>
<p>R Tidy code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">furrr</span><span class="p">)</span>

<span class="c1"># Generate a list of numbers</span>
<span class="n">numbers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">100</span>

<span class="c1"># Use the future_map function from furrr to parallelize the map function</span>
<span class="n">start</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>
<span class="n">squares</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">future_map</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Run time: &#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">Sys.time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Run time:  4.94922685623169&quot;
</code></pre></div>
<p>In this example, we first load the Tidyverse and furrr libraries. We
then generate a list of numbers from 1 to 10. We then use the plan
function to set the parallelization strategy to “multisession”, which
will use multiple CPU cores to execute the code. Finally, we use the
future_map function from furrr to apply the function x^2 to each number
in the list in parallel.</p>
<h3 id="parallel-computing-in-python">Parallel computing in Python<a class="headerlink" href="#parallel-computing-in-python" title="Permanent link">&para;</a></h3>
<p>In Python, the standard library includes the <code>multiprocessing</code> module
and the <code>threading</code> module, which provides basic support for parallel
computing. By convention, these modules have matching classes like
<code>Pool</code> below which are imported individually. This allows you to switch
between <strong>threading</strong> (sharing memory resources) and <strong>multiprocessing</strong>
(pre-allocated memory resources) without needing to change your code.
This choice is beyond the scope of this workshop, but in both directions
can be a cause of differences in performance.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: Python can give you more control over your
multitasking. That also means you have more power to mess things up.
One infamous problem you can run into is called the GIL or Global
Interpreter Lock. This happens when multiple threads try to run code
at the same time (processes don’t have this constraint) and Python
won’t let them. This is not a problem when your code is
memory-limited, but can definitely be a problem with CPU-limited code.
You can also run into problems with file access and the GIL.</p>
</blockquote>
<p>Here is an example of using the multiprocessing module to execute a loop
in parallel:</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>

<span class="c1"># Generate a list of numbers</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000001</span><span class="p">))</span>

<span class="c1"># Use a for loop</span>
<span class="n">for_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
    <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run time with for loop: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">for_start</span><span class="p">))</span>

<span class="c1"># Use the map function and a pool of workers to parallelize the square function</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Run time with for loop: 0.4019489288330078
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">squares</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="nb">pow</span><span class="p">,</span> <span class="n">numbers</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run time with Pool: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Run time with Pool: 0.2741971015930176
</code></pre></div>
<p>Like R, if we used fewer numbers we don’t necessarily see and advantage
to parallelizing.</p>
<p>In this example, we define a function myfunc() that takes an input x and
returns x^2. We generate some data mydata and use the Pool class from
the multiprocessing module to set up a pool of 4 workers. We then use
the map() method of the Pool class to apply myfunc() to each element of
mydata in parallel.</p>
<blockquote>
<p><strong>GOTCHA ALERT</strong>: When multiprocessing in Python, you sometimes can’t
use your own function unless you have imported it from another file.
Go figure.</p>
</blockquote>
<p>Another option in Python is the <code>dask</code> library. <code>dask</code> is a
sophisticated library for working with larger-than-memory datasets on a
variety of different types of systems from personal computers to
high-performance clusters, and is (some of us believe) by itself a great
reason to use Python if certain types of multiprocessing are needed. We
don’t have an example here because <code>dask</code> is designed to work with
objects like <code>pandas</code> <code>DataFrames</code> and <code>xarray</code> <code>DataArrays</code>. You can
check out a range of examples on the <a href="https://docs.dask.org/en/stable/">dask documentation
page</a>.</p>
<h2 id="data-wrangling">Data wrangling<a class="headerlink" href="#data-wrangling" title="Permanent link">&para;</a></h2>
<p>Data wrangling is an important part of any data analysis project, and
both R and Python provide tools and libraries for performing this task.
Data wrangling can include:</p>
<ul>
<li>
<p>Filtering data to study parameters</p>
</li>
<li>
<p>Ensuring that nodata values are interpreted correctly</p>
</li>
<li>
<p>Ensuring that data has the correct number and type of dimensions</p>
</li>
<li>
<p>Converting units</p>
</li>
<li>
<p>Reprojecting spatial coordinates</p>
</li>
<li>
<p>Parsing dates and times</p>
</li>
<li>
<p>Pivoting - Changing between long (or <strong>tidy</strong>) and wide data formats.
  Tidy data contains only a single observation in each row. Different
  statistical models require different data formats.</p>
</li>
<li>
<p>Joining - combining multiple datasets on common column values or
  <strong>key</strong></p>
</li>
</ul>
<h3 id="data-wrangling-in-r-tidyverse">Data Wrangling in R Tidyverse<a class="headerlink" href="#data-wrangling-in-r-tidyverse" title="Permanent link">&para;</a></h3>
<p>The tidyverse is a collection of R packages designed for data science,
and it includes several packages that are useful for data wrangling. One
of the most popular packages is dplyr, which provides a grammar of data
manipulation for data frames.</p>
<p>Here is an example of using dplyr to filter, mutate, and summarize a
data frame:</p>
<p>R code</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Attaching package: &#39;dplyr&#39;

The following objects are masked from &#39;package:stats&#39;:

    filter, lag

The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union
</code></pre></div>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Load data</span>
<span class="nf">data</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>


<span class="n">mtcars</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># Filter for cars with more than 100 horsepower</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">hp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># Add a new column with fuel efficiency in km per liter</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">kmpl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.425</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mpg</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># Group by number of cylinders and summarize</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">mean_hp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">hp</span><span class="p">),</span>
<span class="w">            </span><span class="n">mean_kmpl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">kmpl</span><span class="p">))</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 3 × 3
    cyl mean_hp mean_kmpl
  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1     4    111      11.0 
2     6    122.      8.39
3     8    209.      6.42
</code></pre></div>
<p>In this example, we first filter the mtcars data frame to only include
cars with more than 100 horsepower. We then use mutate to create a new
column with fuel efficiency in kilometers per liter. Finally, we group
the data by the number of cylinders and calculate the mean horsepower
and fuel efficiency.</p>
<h3 id="data-wrangling-in-python-pandas">Data Wrangling in Python Pandas<a class="headerlink" href="#data-wrangling-in-python-pandas" title="Permanent link">&para;</a></h3>
<p>Pandas is a popular library for data manipulation in Python. It provides
a data frame object similar to R’s data frames, along with a wide range
of functions for data wrangling. The code below performs the same
operations as the R code above:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="n">r</span><span class="o">.</span><span class="n">mtcars</span>
    <span class="c1"># Filter for cars with more than 100 horsepower</span>
    <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">mtcars</span><span class="o">.</span><span class="n">hp</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">]</span>
    <span class="c1"># Add a new column with fuel efficiency in km per liter</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">kmpl</span><span class="o">=</span><span class="mf">0.425</span><span class="o">*</span><span class="n">r</span><span class="o">.</span><span class="n">mtcars</span><span class="o">.</span><span class="n">mpg</span><span class="p">)</span>
    <span class="c1"># Group by number of cylinders and summarize</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;cyl&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mean_hp</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span> 
         <span class="n">mean_kmpl</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kmpl&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
<span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>        mean_hp  mean_kmpl
cyl                       
4.0  111.000000  11.007500
6.0  122.285714   8.390714
8.0  209.214286   6.417500
</code></pre></div>
<h2 id="data-from-api">Data from API<a class="headerlink" href="#data-from-api" title="Permanent link">&para;</a></h2>
<p>An Application Programming Interface (API) is a method of accessing data
or services using automated code. When we talk about data APIs, we are
usually referring to web APIs which are accessed over HTTP(S) using URLs
(just like you put in your web browser).</p>
<p>To decipher API documentation, you need to know a little about URLs.
Take a look at the following graphic from <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL">mdn
webdocs</a>:</p>
<p><img alt="Anatomy of a URL from mdn
webdocs" src="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL/mdn-url-all.png" /></p>
<p>For an API, the main part you need to pay attention to is the
parameters - these are going to tell the data provider which data we
want to download.</p>
<p>Most APIs require that you sign up for an API key or developer key. This
allows them to track who is downloading the data and make sure than no
one user is putting undue stress on their system. <strong>YOU SHOULD NOT
PUBLISH YOUR API KEYS</strong>. Even if the data is open, there are
web-scraping bots out there that can attack data providers, for example
by making so many requests that the service can’t respond to anyone
(denial-of-service attack). Some data providers will discontinue access
for you if your API key is used in an attack - even if it was
inadvertent. We recommend storing your API key in a file in your home
folder and importing it. You can also use the GitHub Secrets feature to
store an API key without making it accessible on the open web.</p>
<p>Retrieving data from an API is a common task in both R and Python.
Sometimes, data managers provide a library for getting data, like the
OpenStreetMap data earlier, which takes care of URL formatting for us.
Other times, we must determine the correct HTTP(S) URL for the data
using the API documentation. The examples below will show how to
download data using API URLs in R and Python.</p>
<h3 id="openweathermap">OpenWeatherMap<a class="headerlink" href="#openweathermap" title="Permanent link">&para;</a></h3>
<h4 id="r">R<a class="headerlink" href="#r" title="Permanent link">&para;</a></h4>
<p>In R, we can use the httr package to retrieve data from an API. Here’s
an example of how to retrieve weather data from the OpenWeatherMap API
in R. You will need to replace <code>API_KEY</code> with an <a href="https://openweathermap.org/faq">API key from the
OpenWeatherMap site</a>:</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">httr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>

<span class="c1"># Download</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;https://api.openweathermap.org/data/2.5/weather?q=London,uk&amp;appid=API_KEY&#39;</span>

<span class="n">response</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">GET</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">content</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;text&#39;</span><span class="p">)</span>

<span class="c1"># Convert content to JSON</span>
<span class="n">json</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fromJSON</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># Convert JSON to a data frame</span>
<span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

</details>

<p>We first load the httr library, then construct the API URL and use the
GET() function to make a request to the API. We then extract the data
from the response using the content() function and print the resulting
data.</p>
<h4 id="python">Python<a class="headerlink" href="#python" title="Permanent link">&para;</a></h4>
<p>To retrieve data from an API in Python, we can use the requests library.
Here’s an example of how to retrieve weather data from the
OpenWeatherMap API.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.openweathermap.org/data/2.5/weather?q=London,uk&amp;appid=API_KEY&#39;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="n">json_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>

</details>

<p>This code retrieves the current weather data for London from the
OpenWeatherMap API. We first construct the API URL with the location and
API key, then use the requests.get() function to make a request to the
API. We then extract the JSON data from the response using the .json()
method and print the resulting data.</p>
<p>Retrieving Data from an API in R Tidyverse In R Tidyverse, we can use
the httr and jsonlite packages to retrieve and process data from an API.</p>
<p>Comparison</p>
<ul>
<li>Both R Tidyverse and Python provide powerful tools for retrieving and
  processing data from an API. In terms of syntax, the two languages are
  somewhat similar. In both cases, we use a library to retrieve data
  from the API, extract the content of the response, and then process
  the JSON data. However, there are some differences in the specific
  functions and methods used. For example, in R Tidyverse, we use the
  content() function to extract the content of the response, whereas in
  Python, we use the content attribute. Additionally, in R Tidyverse, we
  use the fromJSON() function to convert the JSON data to a list,
  whereas in Python, we use the loads() function.</li>
</ul>
<h3 id="census-data">Census data<a class="headerlink" href="#census-data" title="Permanent link">&para;</a></h3>
<p>Retrieving USA census data in R, R Tidy, and Python can be done using
different packages and libraries. Here are some working examples in code
for each language:</p>
<h4 id="r_1">R:<a class="headerlink" href="#r_1" title="Permanent link">&para;</a></h4>
<p>To retrieve census data in R, we can use the tidycensus package. Here’s
an example of how to retrieve the total population for the state of
California:</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">tidycensus</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="c1"># Set your Census API key</span>
<span class="nf">census_api_key</span><span class="p">(</span><span class="s">&quot;your_api_key&quot;</span><span class="p">)</span>

<span class="c1"># Get the total population for the state of California</span>
<span class="n">ca_pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">get_acs</span><span class="p">(</span>
<span class="w">  </span><span class="n">geography</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;state&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;B01003_001&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CA&quot;</span>
<span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">rename</span><span class="p">(</span><span class="n">total_population</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">estimate</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">total_population</span><span class="p">)</span>

<span class="c1"># View the result</span>
<span class="n">ca_pop</span>
</code></pre></div>

</details>

<h4 id="python_1">Python:<a class="headerlink" href="#python_1" title="Permanent link">&para;</a></h4>
<p>To retrieve census data in Python, we can use the census library. Here’s
an example of how to retrieve the total population for the state of
California:</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">census</span> <span class="kn">import</span> <span class="n">Census</span>
<span class="kn">from</span> <span class="nn">us</span> <span class="kn">import</span> <span class="n">states</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Set your Census API key</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Census</span><span class="p">(</span><span class="s2">&quot;your_api_key&quot;</span><span class="p">)</span>

<span class="c1"># Get the total population for the state of California</span>
<span class="n">ca_pop</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">acs5</span><span class="o">.</span><span class="n">state</span><span class="p">((</span><span class="s2">&quot;B01003_001&quot;</span><span class="p">),</span> <span class="n">states</span><span class="o">.</span><span class="n">CA</span><span class="o">.</span><span class="n">fips</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="mi">2019</span><span class="p">)</span>

<span class="c1"># Convert the result to a Pandas DataFrame</span>
<span class="n">ca_pop_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ca_pop</span><span class="p">)</span>

<span class="c1"># Rename the column</span>
<span class="n">ca_pop_df</span> <span class="o">=</span> <span class="n">ca_pop_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;B01003_001E&quot;</span><span class="p">:</span> <span class="s2">&quot;total_population&quot;</span><span class="p">})</span>

<span class="c1"># Select only the total population column</span>
<span class="n">ca_pop_df</span> <span class="o">=</span> <span class="n">ca_pop_df</span><span class="p">[[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]]</span>

<span class="c1"># View the result</span>
<span class="n">ca_pop_df</span>
</code></pre></div>

</details>

<h3 id="lidar-data">Lidar data<a class="headerlink" href="#lidar-data" title="Permanent link">&para;</a></h3>
<p>To find Lidar data in R and Python, you typically need to start by
identifying sources of Lidar data and then accessing them using
appropriate packages and functions. Here are some examples of how to
find Lidar data in R and Python:</p>
<p>R:</p>
<p>Identify sources of Lidar data:</p>
<p>The USGS National Map Viewer provides access to Lidar data for the
United States. You can also find Lidar data on state and local
government websites, as well as on commercial data providers’ websites.
Access the data: You can use the lidR package in R to download and read
Lidar data in the LAS format. For example, the following code downloads
and reads Lidar data for a specific area:</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">lidR</span><span class="p">)</span>

<span class="c1"># Download Lidar data</span>
<span class="n">LASfile</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">system.file</span><span class="p">(</span><span class="s">&quot;extdata&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Megaplot.laz&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="o">=</span><span class="s">&quot;lidR&quot;</span><span class="p">)</span>
<span class="n">lidar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">readLAS</span><span class="p">(</span><span class="n">LASfile</span><span class="p">)</span>

<span class="c1"># Visualize the data</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">lidar</span><span class="p">)</span>
</code></pre></div>

</details>

<p>Python:</p>
<p>Identify sources of Lidar data: The USGS 3DEP program provides access to
Lidar data for the United States. You can also find Lidar data on state
and local government websites, as well as on commercial data providers’
websites. Access the data: You can use the pylastools package in Python
to download and read Lidar data in the LAS format. For example, the
following code downloads and reads Lidar data for a specific area:</p>
<p>Python code:</p>
<div class="highlight"><pre><span></span><code><span class="nf">py_install</span><span class="p">(</span><span class="s">&quot;requests&quot;</span><span class="p">)</span>
<span class="nf">py_install</span><span class="p">(</span><span class="s">&quot;pylas&quot;</span><span class="p">)</span>
<span class="nf">py_install</span><span class="p">(</span><span class="s">&quot;laspy&quot;</span><span class="p">)</span>
</code></pre></div>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">pylas</span> <span class="kn">import</span> <span class="n">read</span>
<span class="kn">import</span> <span class="nn">laspy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Download Lidar data</span>
<span class="n">url</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;https://s3-us-west-2.amazonaws.com/usgs-lidar-public/&quot;</span>
       <span class="s2">&quot;USGS_LPC_CA_SanFrancisco_2016_LAS_2018.zip&quot;</span><span class="p">)</span>

<span class="c1"># Unzip</span>
<span class="k">with</span>

<span class="n">lasfile</span> <span class="o">=</span> <span class="s2">&quot;USGS_LPC_CA_SanFrancisco_2016_LAS_2018.las&quot;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="nb">open</span><span class="p">(</span><span class="n">lasfile</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># Read the data</span>
<span class="n">lidar</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">lasfile</span><span class="p">)</span>

<span class="c1"># Visualize the data</span>
<span class="n">laspy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lidar</span><span class="p">)</span>
</code></pre></div>

</details>

<h3 id="data-for-black-lives">Data for black lives<a class="headerlink" href="#data-for-black-lives" title="Permanent link">&para;</a></h3>
<p>Data for Black Lives (<a href="https://d4bl.org/">https://d4bl.org/</a>) is a movement that uses data
science to create measurable change in the lives of Black people. While
the Data for Black Lives website provides resources, reports, articles,
and datasets related to racial equity, it doesn’t provide a direct API
for downloading data.</p>
<p>Instead, you can access the Data for Black Lives GitHub repository
(<a href="https://github.com/Data4BlackLives">https://github.com/Data4BlackLives</a>) to find datasets and resources to
work with. In this example, we’ll use a sample dataset available at
<a href="https://github.com/Data4BlackLives/covid-19/tree/master/data">https://github.com/Data4BlackLives/covid-19/tree/master/data</a>. The
dataset “COVID19_race_data.csv” contains COVID-19 race-related data.</p>
<h4 id="r_2">R:<a class="headerlink" href="#r_2" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘readr’ and ‘dplyr’ packages to read, process, and
analyze the dataset.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>

<span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Read the CSV file</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/Data4BlackLives/covid-19/master/data/COVID19_race_data.csv&quot;</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Basic information about the dataset</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="c1"># Example analysis: calculate the mean of &#39;cases_total&#39; by &#39;state&#39;</span>
<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">mean_cases_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">cases_total</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">mean_cases_total</span><span class="p">))</span>
</code></pre></div>

</details>

<h4 id="python_2">Python:<a class="headerlink" href="#python_2" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘pandas’ library to read, process, and analyze
the dataset.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Read the CSV file</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/Data4BlackLives/covid-19/master/data/COVID19_race_data.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Basic information about the dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Example analysis: calculate the mean of &#39;cases_total&#39; by &#39;state&#39;</span>
<span class="n">mean_cases_total</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)[</span><span class="s2">&quot;cases_total&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_cases_total</span><span class="p">)</span>
</code></pre></div>

</details>

<p>In conclusion, both R and Python provide powerful libraries and tools
for downloading, processing, and analyzing datasets, such as those found
in the Data for Black Lives repository. The ‘readr’ and ‘dplyr’
libraries in R offer a simple and intuitive way to read and manipulate
data, while the ‘pandas’ library in Python offers similar functionality
with a different syntax. Depending on your preferred programming
language and environment, both options can be effective in working with
social justice datasets.</p>
<h3 id="propublica-congress-api">Propublica Congress API<a class="headerlink" href="#propublica-congress-api" title="Permanent link">&para;</a></h3>
<p>The ProPublica Congress API provides information about the U.S. Congress
members and their voting records. In this example, we’ll fetch data
about the current Senate members and calculate the number of members in
each party.</p>
<h4 id="r_3">R:<a class="headerlink" href="#r_3" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘httr’ and ‘jsonlite’ packages to fetch and process
data from the ProPublica Congress API.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># load necessary libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">httr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>

<span class="c1"># Replace &#39;your_api_key&#39; with your ProPublica API key</span>
<span class="n">api_key</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;your_api_key&#39;</span>

<span class="c1"># Fetch data about the current Senate members</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://api.propublica.org/congress/v1/117/senate/members.json&quot;</span>
<span class="n">response</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">GET</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="nf">add_headers</span><span class="p">(</span><span class="n">`X-API-Key`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">api_key</span><span class="p">))</span>

<span class="c1"># Check if the request was successful</span>
<span class="nf">if </span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Success&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">content</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;parsed&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">members</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">results</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="o">$</span><span class="n">members</span>

<span class="w">  </span><span class="c1"># Calculate the number of members in each party</span>
<span class="w">  </span><span class="n">party_counts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="nf">sapply</span><span class="p">(</span><span class="n">members</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">party</span><span class="p">))</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="n">party_counts</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Server error: (500) Internal Server Error&quot;
</code></pre></div>
<h4 id="python_3">Python<a class="headerlink" href="#python_3" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘requests’ library to fetch data from the
ProPublica Congress API and ‘pandas’ library to process the data.</p>
<p>python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install necessary libraries</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Replace &#39;your_api_key&#39; with your ProPublica API key</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s2">&quot;your_api_key&quot;</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X-API-Key&quot;</span><span class="p">:</span> <span class="n">api_key</span><span class="p">}</span>

<span class="c1"># Fetch data about the current Senate members</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.propublica.org/congress/v1/117/senate/members.json&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="c1"># Check if the request was successful</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">members</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;members&quot;</span><span class="p">]</span>

    <span class="c1"># Calculate the number of members in each party</span>
    <span class="n">party_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">members</span><span class="p">)[</span><span class="s2">&quot;party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">party_counts</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

</details>

<p>In conclusion, both R and Python offer efficient ways to fetch and
process data from APIs like the ProPublica Congress API. The ‘httr’ and
‘jsonlite’ libraries in R provide a straightforward way to make HTTP
requests and parse JSON data, while the ‘requests’ library in Python
offers similar functionality. The ‘pandas’ library in Python can be used
for data manipulation and analysis, and R provides built-in functions
like table() for aggregating data. Depending on your preferred
programming language and environment, both options can be effective for
working with the ProPublica Congress API.</p>
<h3 id="nonprofit-explorer-api-by-propublica">Nonprofit Explorer API by ProPublica<a class="headerlink" href="#nonprofit-explorer-api-by-propublica" title="Permanent link">&para;</a></h3>
<p>The Nonprofit Explorer API by ProPublica provides data on tax-exempt
organizations in the United States. In this example, we’ll search for
organizations with the keyword “education” and analyze the results.</p>
<h4 id="r_4">R<a class="headerlink" href="#r_4" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘httr’ and ‘jsonlite’ packages to fetch and process
data from the Nonprofit Explorer API.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">httr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>

<span class="c1"># Fetch data for organizations with the keyword &quot;education&quot;</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://projects.propublica.org/nonprofits/api/v2/search.json?q=education&quot;</span>
<span class="n">response</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">GET</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Check if the request was successful</span>
<span class="nf">if </span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Success&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">content</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;parsed&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">organizations</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">organizations</span>

<span class="w">  </span><span class="c1"># Count the number of organizations per state</span>
<span class="w">  </span><span class="n">state_counts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">table</span><span class="p">(</span><span class="nf">sapply</span><span class="p">(</span><span class="n">organizations</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">$</span><span class="n">state</span><span class="p">))</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="n">state_counts</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>     AZ      CA      CO      DC      FL      GA      HI      IA      ID      IL 
      3      19       6       2       4       1       1       1       1       5 
Indiana      LA      MA      MD      MI      MN      MO      MP      MS      NC 
      1       2       1       1       2       5       3       1       2       2 
     ND      NE      NJ      NY      OH  Oregon      PA      TX      UT      VA 
      1       1       3       1       6       1       2      13       2       3 
     WA      ZZ 
      2       2
</code></pre></div>
<h4 id="python_4">Python<a class="headerlink" href="#python_4" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘requests’ library to fetch data from the
Nonprofit Explorer API and ‘pandas’ library to process the data.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install necessary libraries</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Fetch data for organizations with the keyword &quot;education&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://projects.propublica.org/nonprofits/api/v2/search.json?q=education&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Check if the request was successful</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">organizations</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;organizations&quot;</span><span class="p">]</span>

    <span class="c1"># Count the number of organizations per state</span>
    <span class="n">state_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">organizations</span><span class="p">)[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state_counts</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>CA         19
TX         13
OH          6
CO          6
IL          5
MN          5
FL          4
MO          3
NJ          3
VA          3
AZ          3
DC          2
MS          2
WA          2
MI          2
UT          2
NC          2
LA          2
PA          2
ZZ          2
Indiana     1
NE          1
NY          1
Oregon      1
HI          1
GA          1
MP          1
MD          1
IA          1
ID          1
ND          1
MA          1
Name: state, dtype: int64
</code></pre></div>
<p>In conclusion, both R and Python offer efficient ways to fetch and
process data from APIs like the Nonprofit Explorer API. The ‘httr’ and
‘jsonlite’ libraries in R provide a straightforward way to make HTTP
requests and parse JSON data, while the ‘requests’ library in Python
offers similar functionality. The ‘pandas’ library in Python can be used
for data manipulation and analysis, and R provides built-in functions
like table() for aggregating data. Depending on your preferred
programming language and environment, both options can be effective for
working with the Nonprofit Explorer API.</p>
<h3 id="campaign-finance-api-by-propublica">Campaign Finance API by ProPublica<a class="headerlink" href="#campaign-finance-api-by-propublica" title="Permanent link">&para;</a></h3>
<p>The Campaign Finance API by the Federal Election Commission (FEC)
provides data on campaign finance in U.S. federal elections. In this
example, we’ll fetch data about individual contributions for the 2020
election cycle and analyze the results.</p>
<h4 id="r_5">R<a class="headerlink" href="#r_5" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘httr’ and ‘jsonlite’ packages to fetch and process
data from the Campaign Finance API.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">httr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>

<span class="c1"># Fetch data about individual contributions for the 2020 election cycle</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://api.open.fec.gov/v1/schedules/schedule_a/?api_key=&#39;OGwpkX7tH5Jihs1qQcisKfVAMddJzmzouWKtKoby&#39;&amp;two_year_transaction_period=2020&amp;sort_hide_null=false&amp;sort_null_only=false&amp;per_page=20&amp;page=1&quot;</span>
<span class="n">response</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">GET</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Check if the request was successful</span>
<span class="nf">if </span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">category</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Success&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">content</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;parsed&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">contributions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">$</span><span class="n">results</span>

<span class="w">  </span><span class="c1"># Calculate the total contributions per state</span>
<span class="w">  </span><span class="n">state_totals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aggregate</span><span class="p">(</span><span class="n">contributions</span><span class="o">$</span><span class="n">contributor_state</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">contributions</span><span class="o">$</span><span class="n">contributor_state</span><span class="p">),</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span>
<span class="w">  </span><span class="nf">colnames</span><span class="p">(</span><span class="n">state_totals</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;State&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Total_Contributions&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="n">state_totals</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="nf">http_status</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">$</span><span class="n">message</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>[1] &quot;Client error: (403) Forbidden&quot;
</code></pre></div>
<h4 id="python_5">Python<a class="headerlink" href="#python_5" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘requests’ library to fetch data from the
Campaign Finance API and ‘pandas’ library to process the data.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install necessary libraries</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Fetch data about individual contributions for the 2020 election cycle</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://api.open.fec.gov/v1/schedules/schedule_a/?api_key=your_api_key&amp;two_year_transaction_period=2020&amp;sort_hide_null=false&amp;sort_null_only=false&amp;per_page=20&amp;page=1&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Check if the request was successful</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">contributions</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>

    <span class="c1"># Calculate the total contributions per state</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
    <span class="n">state_totals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;contributor_state&quot;</span><span class="p">)[</span><span class="s2">&quot;contribution_receipt_amount&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">state_totals</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Error: 403
</code></pre></div>
<p>In conclusion, both R and Python offer efficient ways to fetch and
process data from APIs like the Campaign Finance API. The ‘httr’ and
‘jsonlite’ libraries in R provide a straightforward way to make HTTP
requests and parse JSON data, while the ‘requests’ library in Python
offers similar functionality. The ‘pandas’ library in Python can be used
for data manipulation and analysis, and R provides built-in functions
like aggregate() for aggregating data. Depending on your preferred
programming language and environment, both options can be effective for
working with the Campaign Finance API.</p>
<p>Note: Remember to replace your_api_key with your actual FEC API key in
the code examples above.</p>
<h3 id="historic-redlining">Historic Redlining<a class="headerlink" href="#historic-redlining" title="Permanent link">&para;</a></h3>
<p>Historic redlining data refers to data from the Home Owners’ Loan
Corporation (HOLC) that created residential security maps in the 1930s,
which contributed to racial segregation and disinvestment in minority
neighborhoods. One popular source for this data is the Mapping
Inequality project (<a href="https://dsl.richmond.edu/panorama/redlining/">https://dsl.richmond.edu/panorama/redlining/</a>).</p>
<p>In this example, we’ll download historic redlining data for Philadelphia
in the form of a GeoJSON file and analyze the data in R and Python.</p>
<h4 id="r_6">R<a class="headerlink" href="#r_6" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘sf’ and ‘dplyr’ packages to read and process the
GeoJSON data.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Download historic redlining data for Philadelphia</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://dsl.richmond.edu/panorama/redlining/static/downloads/geojson/PAPhiladelphia1937.geojson&quot;</span>
<span class="n">philly_geojson</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_sf</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Count the number of areas per HOLC grade</span>
<span class="n">grade_counts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">philly_geojson</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">holc_grade</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarize</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">())</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">grade_counts</span><span class="p">)</span>
</code></pre></div>

</details>

<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-75-1.png" /></p>
<h4 id="python_6">Python<a class="headerlink" href="#python_6" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘geopandas’ library to read and process the
GeoJSON data.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install necessary libraries</span>


<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1"># Download historic redlining data for Philadelphia</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://dsl.richmond.edu/panorama/redlining/static/downloads/geojson/PAPhiladelphia1937.geojson&quot;</span>
<span class="n">philly_geojson</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Count the number of areas per HOLC grade</span>
<span class="n">grade_counts</span> <span class="o">=</span> <span class="n">philly_geojson</span><span class="p">[</span><span class="s2">&quot;holc_grade&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grade_counts</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>B    28
D    26
C    18
A    10
Name: holc_grade, dtype: int64
</code></pre></div>
<p>In conclusion, both R and Python offer efficient ways to download and
process historic redlining data in the form of GeoJSON files. The ‘sf’
package in R provides a simple way to read and manipulate spatial data,
while the ‘geopandas’ library in Python offers similar functionality.
The ‘dplyr’ package in R can be used for data manipulation and analysis,
and Python’s built-in functions like value_counts() can be used for
aggregating data. Depending on your preferred programming language and
environment, both options can be effective for working with historic
redlining data.</p>
<h3 id="indian-entities-recognized-and-eligible-to-receive-services-by-bia">Indian Entities Recognized and Eligible To Receive Services by BIA<a class="headerlink" href="#indian-entities-recognized-and-eligible-to-receive-services-by-bia" title="Permanent link">&para;</a></h3>
<p>The Bureau of Indian Affairs (BIA) provides a PDF document containing a
list of Indian Entities Recognized and Eligible To Receive Services. To
analyze the data, we’ll first need to extract the information from the
PDF. In this example, we’ll extract the names of the recognized tribes
and count the number of tribes per state.</p>
<h4 id="r_7">R<a class="headerlink" href="#r_7" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘pdftools’ package to extract text from the PDF and
the ‘stringr’ package to process the text data.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">pdftools</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Download the BIA PDF</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://www.govinfo.gov/content/pkg/FR-2022-01-28/pdf/2022-01789.pdf&quot;</span>
<span class="n">temp_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tempfile</span><span class="p">(</span><span class="n">fileext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.pdf&quot;</span><span class="p">)</span>
<span class="nf">download.file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">temp_file</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;wb&quot;</span><span class="p">)</span>

<span class="c1"># Extract text from the PDF</span>
<span class="n">pdf_text</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">pdf_text</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span>
<span class="n">tribe_text</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pdf_text</span><span class="p">[</span><span class="m">4</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">pdf_text</span><span class="p">)]</span>

<span class="c1"># Define helper functions</span>
<span class="n">tribe_state_extractor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">text_line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">regex_pattern</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;(.*),\\s+([A-Z]{2})$&quot;</span>
<span class="w">  </span><span class="n">tribe_state</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">str_match</span><span class="p">(</span><span class="n">text_line</span><span class="p">,</span><span class="w"> </span><span class="n">regex_pattern</span><span class="p">)</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">tribe_state</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">is_valid_tribe_line</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">text_line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">regex_pattern</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;^\\d+\\s+&quot;</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="nf">str_match</span><span class="p">(</span><span class="n">text_line</span><span class="p">,</span><span class="w"> </span><span class="n">regex_pattern</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c1"># Process text data to extract tribes and states</span>
<span class="n">tribe_states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sapply</span><span class="p">(</span><span class="n">tribe_text</span><span class="p">,</span><span class="w"> </span><span class="n">tribe_state_extractor</span><span class="p">)</span>
<span class="n">valid_lines</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sapply</span><span class="p">(</span><span class="n">tribe_text</span><span class="p">,</span><span class="w"> </span><span class="n">is_valid_tribe_line</span><span class="p">)</span>
<span class="n">tribe_states</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tribe_states</span><span class="p">[</span><span class="n">valid_lines</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>

<span class="c1"># Count the number of tribes per state</span>
<span class="n">tribe_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">tribe_states</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">tribe_data</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Tribe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;State&quot;</span><span class="p">)</span>
<span class="n">state_counts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tribe_data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">State</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">summarise</span><span class="p">(</span><span class="n">Count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">())</span>

<span class="nf">print</span><span class="p">(</span><span class="n">state_counts</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code># A tibble: 0 × 2
# ℹ 2 variables: State &lt;chr&gt;, Count &lt;int&gt;
</code></pre></div>
<h4 id="python_7">Python<a class="headerlink" href="#python_7" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘PyPDF2’ library to extract text from the PDF
and the ‘re’ module to process the text data.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install necessary libraries</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">PyPDF2</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="c1"># Download the BIA PDF</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.bia.gov/sites/bia.gov/files/assets/public/raca/online-tribal-leaders-directory/tribal_leaders_2021-12-27.pdf&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Extract text from the PDF</span>
<span class="n">pdf_reader</span> <span class="o">=</span> <span class="n">PyPDF2</span><span class="o">.</span><span class="n">PdfFileReader</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
<span class="n">tribe_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">pdf_reader</span><span class="o">.</span><span class="n">getPage</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">extractText</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">pdf_reader</span><span class="o">.</span><span class="n">numPages</span><span class="p">)]</span>

<span class="c1"># Process text data to extract tribes and states</span>
<span class="n">tribes</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\d+\s+(.+),\s+([A-Z]</span><span class="si">{2}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">tribe_text</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="p">]</span>
<span class="n">tribe_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">state</span> <span class="k">for</span> <span class="n">tribe</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">tribes</span><span class="p">]</span>

<span class="c1"># Count the number of tribes per state</span>
<span class="n">state_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">tribe_states</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state_counts</span><span class="p">)</span>
</code></pre></div>

</details>

<p>In conclusion, both R and Python offer efficient ways to download and
process the list of Indian Entities Recognized and Eligible To Receive
Services from the BIA. The ‘pdftools’ package in R provides a simple way
to extract text from PDF files, while the ‘PyPDF2’ library in Python
offers similar functionality. The ‘stringr’ package in R and the ‘re’
module in Python can be used to process and analyze text data. Depending
on your preferred programming language and environment, both options can
be effective for working with BIA data.</p>
<h3 id="national-atlas-indian-lands-of-the-united-states-dataset">National Atlas - Indian Lands of the United States dataset<a class="headerlink" href="#national-atlas-indian-lands-of-the-united-states-dataset" title="Permanent link">&para;</a></h3>
<p>In this example, we will download and analyze the National Atlas -
Indian Lands of the United States dataset in both R and Python. We will
read the dataset and count the number of Indian lands per state.</p>
<h4 id="r_8">R<a class="headerlink" href="#r_8" title="Permanent link">&para;</a></h4>
<p>In R, we’ll use the ‘sf’ package to read the Shapefile and the ‘dplyr’
package to process the data.</p>
<p>R code:</p>
<details>
<summary>Show the R code</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>

<span class="nf">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="c1"># Download the Indian Lands dataset</span>
<span class="n">url</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Small-scale/data/Boundaries/indlanp010g.shp_nt00968.tar.gz&quot;</span>
<span class="n">temp_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tempfile</span><span class="p">(</span><span class="n">fileext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.tar.gz&quot;</span><span class="p">)</span>
<span class="nf">download.file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="n">temp_file</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;wb&quot;</span><span class="p">)</span>
<span class="nf">untar</span><span class="p">(</span><span class="n">temp_file</span><span class="p">,</span><span class="w"> </span><span class="n">exdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">tempdir</span><span class="p">())</span>

<span class="c1"># Read the Shapefile</span>
<span class="n">shapefile_path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="nf">tempdir</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;indlanp010g.shp&quot;</span><span class="p">)</span>
<span class="n">indian_lands</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_sf</span><span class="p">(</span><span class="n">shapefile_path</span><span class="p">)</span>

<span class="c1"># Count the number of Indian lands per state</span>
<span class="c1"># state_counts &lt;- indian_lands %&gt;%</span>
<span class="c1">#   group_by(STATE) %&gt;%</span>
<span class="c1">#   summarize(count = n())</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">indian_lands</span><span class="p">)</span>
</code></pre></div>

</details>

<div class="highlight"><pre><span></span><code>Warning: plotting the first 9 out of 23 attributes; use max.plot = 23 to plot
all
</code></pre></div>
<p><img alt="" src="../bilingualism_files/figure-commonmark/unnamed-chunk-79-1.png" /></p>
<h4 id="python_8">Python<a class="headerlink" href="#python_8" title="Permanent link">&para;</a></h4>
<p>In Python, we’ll use the ‘geopandas’ and ‘pandas’ libraries to read the
Shapefile and process the data.</p>
<p>Python code:</p>
<details>
<summary>Show the Python code</summary>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="c1"># Download the Indian Lands dataset</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://prd-tnm.s3.amazonaws.com/StagedProducts/Small-scale/data/Boundaries/indlanp010g.shp_nt00966.tar.gz&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">tar_file</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r:gz&#39;</span><span class="p">)</span>

<span class="c1"># Extract Shapefile</span>
<span class="n">temp_dir</span> <span class="o">=</span> <span class="s2">&quot;temp&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

<span class="n">tar_file</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">temp_dir</span><span class="p">)</span>
<span class="n">shapefile_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="s2">&quot;indlanp010g.shp&quot;</span><span class="p">)</span>

<span class="c1"># Read the Shapefile</span>
<span class="n">indian_lands</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shapefile_path</span><span class="p">)</span>

<span class="c1"># Count the number of Indian lands per state</span>
<span class="n">state_counts</span> <span class="o">=</span> <span class="n">indian_lands</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;STATE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">state_counts</span><span class="p">)</span>
</code></pre></div>

</details>

<p>Both R and Python codes download the dataset and read the Shapefile
using the respective packages. They then group the data by the ‘STATE’
attribute and calculate the count of Indian lands per state.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    2024-05-09
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 University of Colorado Boulder
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/cu-esiil/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "toc.integrate", "toc.follow", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>